(window.webpackJsonp=window.webpackJsonp||[]).push([[210],{641:function(s,a,t){"use strict";t.r(a);var e=t(34),n=Object(e.a)({},(function(){var s=this,a=s.$createElement,t=s._self._c||a;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h1",{attrs:{id:"java对外内存分析native-memory-tracking"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#java对外内存分析native-memory-tracking"}},[s._v("#")]),s._v(" Java对外内存分析Native Memory Tracking")]),s._v(" "),t("h2",{attrs:{id:"介绍、使用"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#介绍、使用"}},[s._v("#")]),s._v(" 介绍、使用")]),s._v(" "),t("p",[s._v("Native Memory Tracking是Java提供的来分析native memory的工具，简称NMT，NMT需要在启动程序前增加"),t("code",[s._v("-XX:NativeMemoryTracking=summary")]),s._v("\n启动参数，才能使用。")]),s._v(" "),t("p",[s._v("要注意的是增加这个参数会增加一定（约5%到10%）的性能开销，所以开启时要评估好风险。")]),s._v(" "),t("h3",{attrs:{id:"jcmd查看summary结果"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#jcmd查看summary结果"}},[s._v("#")]),s._v(" jcmd查看summary结果")]),s._v(" "),t("p",[s._v("开启后，通过jcmd pid VM.native_memory即可打印出NMT的统计信息，pid替换成自己的进程id\n比如，以我启动的一个Java进程(pid为67403)为例，输出如下")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("jcmd "),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("67403")]),s._v(" VM.native_memory\n"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("67403")]),s._v(":\n\nNative Memory Tracking:\n\nTotal: "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("reserved")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("10108277KB, "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("committed")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("664301KB\n-                 Java Heap "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("reserved"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("8388608KB, "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("committed")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("524288KB"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n                            "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("mmap: "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("reserved")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("8388608KB, "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("committed")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("524288KB"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n-                     Class "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("reserved"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("1061201KB, "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("committed")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("13521KB"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n                            "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("classes "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#1989)")]),s._v("\n                            "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("  instance classes "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#1808, array classes #181)")]),s._v("\n                            "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("malloc"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("337KB "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#3422)")]),s._v("\n                            "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("mmap: "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("reserved")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("1060864KB, "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("committed")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("13184KB"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n                            "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("  Metadata:   "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n                            "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("    "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("reserved")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("12288KB, "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("committed")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("11776KB"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n                            "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("    "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("used")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("11554KB"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n                            "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("    "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("free")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("222KB"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n                            "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("    "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("waste")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("0KB "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.00")]),s._v("%"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n                            "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("  Class space:"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n                            "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("    "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("reserved")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("1048576KB, "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("committed")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("1408KB"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n                            "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("    "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("used")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("1307KB"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n                            "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("    "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("free")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("101KB"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n                            "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("    "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("waste")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("0KB "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.00")]),s._v("%"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n-                    Thread "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("reserved"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("30853KB, "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("committed")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("30853KB"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n                            "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("thread "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#30)")]),s._v("\n                            "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("stack: "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("reserved")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("30720KB, "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("committed")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("30720KB"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n                            "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("malloc"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("98KB "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#182)")]),s._v("\n                            "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("arena"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("34KB "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#59)")]),s._v("\n\n-                      Code "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("reserved"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("247876KB, "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("committed")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("7740KB"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n                            "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("malloc"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("192KB "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#1502)")]),s._v("\n                            "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("mmap: "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("reserved")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("247684KB, "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("committed")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("7548KB"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n-                        GC "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("reserved"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("374552KB, "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("committed")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("82712KB"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n                            "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("malloc"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("28916KB "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#2628)")]),s._v("\n                            "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("mmap: "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("reserved")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("345636KB, "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("committed")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("53796KB"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n-                  Compiler "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("reserved"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("167KB, "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("committed")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("167KB"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n                            "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("malloc"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("34KB "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#100)")]),s._v("\n                            "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("arena"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("133KB "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#5)")]),s._v("\n\n-                  Internal "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("reserved"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("625KB, "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("committed")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("625KB"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n                            "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("malloc"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("593KB "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#1373)")]),s._v("\n                            "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("mmap: "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("reserved")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("32KB, "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("committed")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("32KB"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n-                     Other "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("reserved"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("2KB, "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("committed")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("2KB"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n                            "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("malloc"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("2KB "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#1)")]),s._v("\n\n-                    Symbol "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("reserved"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("3556KB, "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("committed")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("3556KB"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n                            "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("malloc"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("1886KB "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#7250)")]),s._v("\n                            "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("arena"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("1670KB "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#1)")]),s._v("\n\n-    Native Memory Tracking "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("reserved"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("514KB, "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("committed")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("514KB"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n                            "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("malloc"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("181KB "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#2568)")]),s._v("\n                            "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("tracking "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("overhead")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("332KB"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n-               Arena Chunk "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("reserved"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("176KB, "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("committed")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("176KB"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n                            "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("malloc"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("176KB"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n-                   Logging "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("reserved"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("4KB, "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("committed")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("4KB"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n                            "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("malloc"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("4KB "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#184)")]),s._v("\n\n-                 Arguments "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("reserved"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("27KB, "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("committed")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("27KB"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n                            "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("malloc"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("27KB "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#485)")]),s._v("\n\n-                    Module "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("reserved"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("63KB, "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("committed")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("63KB"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n                            "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("malloc"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("63KB "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#1058)")]),s._v("\n\n-              Synchronizer "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("reserved"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("45KB, "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("committed")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("45KB"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n                            "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("malloc"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("45KB "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#379)")]),s._v("\n\n-                 Safepoint "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("reserved"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("8KB, "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("committed")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("8KB"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n                            "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("mmap: "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("reserved")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("8KB, "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("committed")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("8KB"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br"),t("span",{staticClass:"line-number"},[s._v("31")]),t("br"),t("span",{staticClass:"line-number"},[s._v("32")]),t("br"),t("span",{staticClass:"line-number"},[s._v("33")]),t("br"),t("span",{staticClass:"line-number"},[s._v("34")]),t("br"),t("span",{staticClass:"line-number"},[s._v("35")]),t("br"),t("span",{staticClass:"line-number"},[s._v("36")]),t("br"),t("span",{staticClass:"line-number"},[s._v("37")]),t("br"),t("span",{staticClass:"line-number"},[s._v("38")]),t("br"),t("span",{staticClass:"line-number"},[s._v("39")]),t("br"),t("span",{staticClass:"line-number"},[s._v("40")]),t("br"),t("span",{staticClass:"line-number"},[s._v("41")]),t("br"),t("span",{staticClass:"line-number"},[s._v("42")]),t("br"),t("span",{staticClass:"line-number"},[s._v("43")]),t("br"),t("span",{staticClass:"line-number"},[s._v("44")]),t("br"),t("span",{staticClass:"line-number"},[s._v("45")]),t("br"),t("span",{staticClass:"line-number"},[s._v("46")]),t("br"),t("span",{staticClass:"line-number"},[s._v("47")]),t("br"),t("span",{staticClass:"line-number"},[s._v("48")]),t("br"),t("span",{staticClass:"line-number"},[s._v("49")]),t("br"),t("span",{staticClass:"line-number"},[s._v("50")]),t("br"),t("span",{staticClass:"line-number"},[s._v("51")]),t("br"),t("span",{staticClass:"line-number"},[s._v("52")]),t("br"),t("span",{staticClass:"line-number"},[s._v("53")]),t("br"),t("span",{staticClass:"line-number"},[s._v("54")]),t("br"),t("span",{staticClass:"line-number"},[s._v("55")]),t("br"),t("span",{staticClass:"line-number"},[s._v("56")]),t("br"),t("span",{staticClass:"line-number"},[s._v("57")]),t("br"),t("span",{staticClass:"line-number"},[s._v("58")]),t("br"),t("span",{staticClass:"line-number"},[s._v("59")]),t("br"),t("span",{staticClass:"line-number"},[s._v("60")]),t("br"),t("span",{staticClass:"line-number"},[s._v("61")]),t("br"),t("span",{staticClass:"line-number"},[s._v("62")]),t("br"),t("span",{staticClass:"line-number"},[s._v("63")]),t("br"),t("span",{staticClass:"line-number"},[s._v("64")]),t("br"),t("span",{staticClass:"line-number"},[s._v("65")]),t("br"),t("span",{staticClass:"line-number"},[s._v("66")]),t("br"),t("span",{staticClass:"line-number"},[s._v("67")]),t("br"),t("span",{staticClass:"line-number"},[s._v("68")]),t("br"),t("span",{staticClass:"line-number"},[s._v("69")]),t("br"),t("span",{staticClass:"line-number"},[s._v("70")]),t("br"),t("span",{staticClass:"line-number"},[s._v("71")]),t("br"),t("span",{staticClass:"line-number"},[s._v("72")]),t("br"),t("span",{staticClass:"line-number"},[s._v("73")]),t("br"),t("span",{staticClass:"line-number"},[s._v("74")]),t("br"),t("span",{staticClass:"line-number"},[s._v("75")]),t("br")])]),t("p",[s._v("可以发现每一部分都分成了reserved和committed两个部分，这两个名称的含义是什么呢？")]),s._v(" "),t("p",[s._v("reserved可以理解为进程向操作系统声明我需要使用的内存空间大小，操作系统分配的是虚拟内存，并不会立刻给进程分配真正的物理内存。\ncommitted表示进程真正在使用的内存大小，对应的是物理内存中的空间。\n比如通过java -Xms1G -Xmx2G启动程序时，最开始reserved是2G，committed是1G，随着java堆内存增加，committed也会增加。")]),s._v(" "),t("p",[s._v("一般占用内存比较多的几个部分介绍如下")]),s._v(" "),t("ul",[t("li",[s._v("Class: metadata和classspace，包含class信息，通过"),t("code",[s._v("-XX:MaxMetaspaceSize")]),s._v("能设置metaspace的总大小,classpace可以通过"),t("code",[s._v("-XX:CompressedClassSpaceSize")]),s._v("设置")]),s._v(" "),t("li",[s._v("Thread: 线程栈，大小和ThreadStackSize或Xss配置以及线程数有关")]),s._v(" "),t("li",[s._v("GC: GC垃圾回收器自己使用的内存，比如g1中的remembered set, mark stack等")]),s._v(" "),t("li",[s._v("Code: JIT编译的机器代码，通过"),t("code",[s._v("-XX:ReservedCodeCacheSize")]),s._v("能限制大小")]),s._v(" "),t("li",[s._v("Other: 主要是DirectMemory，比如nio框架使用的DirectBuffer，通过"),t("code",[s._v("-XX:MaxDirectMemorySize")]),s._v("能限制DirectMemory的大小")]),s._v(" "),t("li",[s._v("Symbol: 字符串常量和常量池")])]),s._v(" "),t("h3",{attrs:{id:"查看detail结果"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#查看detail结果"}},[s._v("#")]),s._v(" 查看detail结果")]),s._v(" "),t("p",[s._v("上面通过"),t("code",[s._v("-XX:NativeMemoryTracking=summary")]),s._v("的方式能够看到宏观的各大模块的内存分布，如果想看到更详细的对外内存信息，可以\n通过"),t("code",[s._v("-XX:NativeMemoryTracking=detail")]),s._v("启动，然后通过jcmd pid VM.native_memory detail查看内存详细信息")]),s._v(" "),t("p",[s._v("detail相对于summary增加了更加详细的内存范围和调用栈等信息，部分内容如下")]),s._v(" "),t("div",{staticClass:"language-text line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("Virtual memory map:\n\n[0x0000000100bf0000 - 0x0000000100bf2000] reserved and committed 8KB for Safepoint from\n    [0x0000000101f2cbdf] _ZN18SafepointMechanism18default_initializeEv+0x47\n    [0x0000000101f2ce43] _ZN18SafepointMechanism10initializeEv+0x9\n    [0x0000000101fbb488] _ZN7Threads9create_vmEP14JavaVMInitArgsPb+0x128\n    [0x0000000101ca1388] JNI_CreateJavaVM+0x60\n\n        [0x0000000100bf0000 - 0x0000000100bf2000] committed 8KB from\n            [0x0000000101f2cbf6] _ZN18SafepointMechanism18default_initializeEv+0x5e\n            [0x0000000101f2ce43] _ZN18SafepointMechanism10initializeEv+0x9\n            [0x0000000101fbb488] _ZN7Threads9create_vmEP14JavaVMInitArgsPb+0x128\n            [0x0000000101ca1388] JNI_CreateJavaVM+0x60\n\n[0x0000000100bf2000 - 0x0000000100bfa000] reserved and committed 32KB for Internal from\n    [0x0000000101eecee3] _ZN10PerfMemory20create_memory_regionEm+0x411\n    [0x0000000101eec603] _ZN10PerfMemory10initializeEv+0x65\n    [0x0000000101c30066] _Z15vm_init_globalsv+0x22\n    [0x0000000101fbb4de] _ZN7Threads9create_vmEP14JavaVMInitArgsPb+0x17e\n\n[0x0000000100cb4000 - 0x0000000100cc3000] reserved 60KB for Code from\n    [0x0000000101ff9dfb] _ZN13ReservedSpace10initializeEmmbPcb+0xc5\n    [0x0000000101c14562] _ZN8CodeHeap7reserveE13ReservedSpacemm+0x1b8\n    [0x0000000101aaec9b] _ZN9CodeCache8add_heapE13ReservedSpacePKci+0xc9\n    [0x0000000101aae9a8] _ZN9CodeCache16initialize_heapsEv+0x3d8\n\n        [0x0000000100cb4000 - 0x0000000100cb9000] committed 20KB from\n            [0x0000000101ffb0b5] _ZL15commit_expandedPcmmbb+0x1c\n            [0x0000000101ffaf1b] _ZN12VirtualSpace9expand_byEmb+0x107\n            [0x0000000101ffadfa] _ZN12VirtualSpace27initialize_with_granularityE13ReservedSpacemm+0xa6\n            [0x0000000101c14593] _ZN8CodeHeap7reserveE13ReservedSpacemm+0x1e9\n\n[0x0000000100cc3000 - 0x0000000100dac000] reserved 932KB for Code from\n    [0x0000000101ff9dfb] _ZN13ReservedSpace10initializeEmmbPcb+0xc5\n    [0x0000000101c14562] _ZN8CodeHeap7reserveE13ReservedSpacemm+0x1b8\n    [0x0000000101aaec9b] _ZN9CodeCache8add_heapE13ReservedSpacePKci+0xc9\n    [0x0000000101aae9e2] _ZN9CodeCache16initialize_heapsEv+0x412\n\n        [0x0000000100cc3000 - 0x0000000100cc8000] committed 20KB from\n            [0x0000000101ffb0b5] _ZL15commit_expandedPcmmbb+0x1c\n            [0x0000000101ffaf1b] _ZN12VirtualSpace9expand_byEmb+0x107\n            [0x0000000101ffadfa] _ZN12VirtualSpace27initialize_with_granularityE13ReservedSpacemm+0xa6\n            [0x0000000101c14593] _ZN8CodeHeap7reserveE13ReservedSpacemm+0x1e9\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br"),t("span",{staticClass:"line-number"},[s._v("31")]),t("br"),t("span",{staticClass:"line-number"},[s._v("32")]),t("br"),t("span",{staticClass:"line-number"},[s._v("33")]),t("br"),t("span",{staticClass:"line-number"},[s._v("34")]),t("br"),t("span",{staticClass:"line-number"},[s._v("35")]),t("br"),t("span",{staticClass:"line-number"},[s._v("36")]),t("br"),t("span",{staticClass:"line-number"},[s._v("37")]),t("br"),t("span",{staticClass:"line-number"},[s._v("38")]),t("br"),t("span",{staticClass:"line-number"},[s._v("39")]),t("br"),t("span",{staticClass:"line-number"},[s._v("40")]),t("br"),t("span",{staticClass:"line-number"},[s._v("41")]),t("br"),t("span",{staticClass:"line-number"},[s._v("42")]),t("br"),t("span",{staticClass:"line-number"},[s._v("43")]),t("br")])]),t("h3",{attrs:{id:"查看增长"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#查看增长"}},[s._v("#")]),s._v(" 查看增长")]),s._v(" "),t("p",[s._v("有时候我们发现程序的堆外内存不断增长，为了避免超出内存限制（比如机器内存或容器内存限制）而oom，我们需要定位内存增长的原因，需要知道\n到底是哪里的内存在增加。")]),s._v(" "),t("p",[s._v("jcmd VM.native_memory提供了diff的功能")]),s._v(" "),t("p",[s._v("首先，通过baseline参数设定一个基准线")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# pid换成自己的进程id")]),s._v("\njcmd pid VM.native_memory baseline\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("p",[s._v("然后在一段时间后，通过summary.diff或detail.diff参数来查看内存的变化。")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# pid换成自己的进程id")]),s._v("\njcmd pid VM.native_memory summary.diff\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br")])]),t("p",[s._v("然后就可以看到各个区域的最新值和diff值，diff会通过+/-来表示增长和减少，例如")]),s._v(" "),t("p",[s._v("下图表示committed的总体内存减少了-176KB，Code部分committed增加了2KB，Other部分减少了214KB。")]),s._v(" "),t("div",{staticClass:"language-shell line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-shell"}},[t("code",[s._v("Native Memory Tracking:\n\nTotal: "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("reserved")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("10108437KB -176KB, "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("committed")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("665041KB -176KB\n\n-                 Java Heap "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("reserved"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("8388608KB, "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("committed")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("524288KB"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n                            "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("mmap: "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("reserved")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("8388608KB, "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("committed")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("524288KB"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n-                     Class "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("reserved"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("1061202KB, "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("committed")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("13778KB"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n                            "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("classes "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#1992)")]),s._v("\n                            "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("  instance classes "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#1809, array classes #183)")]),s._v("\n                            "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("malloc"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("338KB "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#3458 +2)")]),s._v("\n                            "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("mmap: "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("reserved")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("1060864KB, "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("committed")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("13440KB"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n                            "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("  Metadata:   "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n                            "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("    "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("reserved")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("12288KB, "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("committed")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("12032KB"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n                            "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("    "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("used")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("11607KB +1KB"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n                            "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("    "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("free")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("425KB -1KB"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n                            "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("    "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("waste")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("0KB "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.00")]),s._v("%"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n                            "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("  Class space:"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n                            "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("    "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("reserved")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("1048576KB, "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("committed")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("1408KB"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n                            "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("    "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("used")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("1307KB"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n                            "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("    "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("free")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("101KB"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n                            "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("    "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("waste")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("0KB "),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("0.00")]),s._v("%"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n-                    Thread "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("reserved"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("30853KB, "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("committed")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("30853KB"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n                            "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("thread "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#30)")]),s._v("\n                            "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("stack: "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("reserved")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("30720KB, "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("committed")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("30720KB"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n                            "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("malloc"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("98KB "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#182)")]),s._v("\n                            "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("arena"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("34KB "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#59)")]),s._v("\n\n-                      Code "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("reserved"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("247889KB +2KB, "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("committed")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("8077KB +2KB"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n                            "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("malloc"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("205KB +2KB "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#1574 +19)")]),s._v("\n                            "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("mmap: "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("reserved")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("247684KB, "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("committed")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("7872KB"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n-                        GC "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("reserved"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("374551KB +5KB, "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("committed")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("82711KB +5KB"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n                            "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("malloc"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("28915KB +5KB "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#2649 +20)")]),s._v("\n                            "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("mmap: "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("reserved")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("345636KB, "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("committed")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("53796KB"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n-                  Compiler "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("reserved"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("166KB, "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("committed")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("166KB"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n                            "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("malloc"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("34KB "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#101)")]),s._v("\n                            "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("arena"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("133KB "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#5)")]),s._v("\n\n-                  Internal "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("reserved"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("636KB, "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("committed")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("636KB"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n                            "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("malloc"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("604KB "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#1402 +3)")]),s._v("\n                            "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("mmap: "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("reserved")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("32KB, "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("committed")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("32KB"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n\n-                     Other "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("reserved"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("69KB -214KB, "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("committed")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("69KB -214KB"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n                            "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("malloc"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("69KB -214KB "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#68 -214)")]),s._v("\n\n-                    Symbol "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("reserved"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("3557KB, "),t("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("committed")]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("3557KB"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(")")]),s._v("\n                            "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("malloc"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("1886KB "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#7270 +11)")]),s._v("\n                            "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("(")]),s._v("arena"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("1670KB "),t("span",{pre:!0,attrs:{class:"token comment"}},[s._v("#1)")]),s._v("\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br"),t("span",{staticClass:"line-number"},[s._v("18")]),t("br"),t("span",{staticClass:"line-number"},[s._v("19")]),t("br"),t("span",{staticClass:"line-number"},[s._v("20")]),t("br"),t("span",{staticClass:"line-number"},[s._v("21")]),t("br"),t("span",{staticClass:"line-number"},[s._v("22")]),t("br"),t("span",{staticClass:"line-number"},[s._v("23")]),t("br"),t("span",{staticClass:"line-number"},[s._v("24")]),t("br"),t("span",{staticClass:"line-number"},[s._v("25")]),t("br"),t("span",{staticClass:"line-number"},[s._v("26")]),t("br"),t("span",{staticClass:"line-number"},[s._v("27")]),t("br"),t("span",{staticClass:"line-number"},[s._v("28")]),t("br"),t("span",{staticClass:"line-number"},[s._v("29")]),t("br"),t("span",{staticClass:"line-number"},[s._v("30")]),t("br"),t("span",{staticClass:"line-number"},[s._v("31")]),t("br"),t("span",{staticClass:"line-number"},[s._v("32")]),t("br"),t("span",{staticClass:"line-number"},[s._v("33")]),t("br"),t("span",{staticClass:"line-number"},[s._v("34")]),t("br"),t("span",{staticClass:"line-number"},[s._v("35")]),t("br"),t("span",{staticClass:"line-number"},[s._v("36")]),t("br"),t("span",{staticClass:"line-number"},[s._v("37")]),t("br"),t("span",{staticClass:"line-number"},[s._v("38")]),t("br"),t("span",{staticClass:"line-number"},[s._v("39")]),t("br"),t("span",{staticClass:"line-number"},[s._v("40")]),t("br"),t("span",{staticClass:"line-number"},[s._v("41")]),t("br"),t("span",{staticClass:"line-number"},[s._v("42")]),t("br"),t("span",{staticClass:"line-number"},[s._v("43")]),t("br"),t("span",{staticClass:"line-number"},[s._v("44")]),t("br"),t("span",{staticClass:"line-number"},[s._v("45")]),t("br"),t("span",{staticClass:"line-number"},[s._v("46")]),t("br"),t("span",{staticClass:"line-number"},[s._v("47")]),t("br"),t("span",{staticClass:"line-number"},[s._v("48")]),t("br"),t("span",{staticClass:"line-number"},[s._v("49")]),t("br"),t("span",{staticClass:"line-number"},[s._v("50")]),t("br"),t("span",{staticClass:"line-number"},[s._v("51")]),t("br")])]),t("h2",{attrs:{id:"其他方式查看内存大小"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#其他方式查看内存大小"}},[s._v("#")]),s._v(" 其他方式查看内存大小")]),s._v(" "),t("p",[s._v("jcmd")]),s._v(" "),t("p",[s._v("arthas")]),s._v(" "),t("h2",{attrs:{id:"常见堆外内存问题"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#常见堆外内存问题"}},[s._v("#")]),s._v(" 常见堆外内存问题")]),s._v(" "),t("p",[s._v("direct buffer\nmetaspace")]),s._v(" "),t("h2",{attrs:{id:"参考"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#参考"}},[s._v("#")]),s._v(" 参考")]),s._v(" "),t("ul",[t("li",[t("a",{attrs:{href:"https://shipilev.net/jvm/anatomy-quarks/12-native-memory-tracking/",target:"_blank",rel:"noopener noreferrer"}},[s._v("native-memory-tracking"),t("OutboundLink")],1)]),s._v(" "),t("li",[t("a",{attrs:{href:"https://www.baeldung.com/native-memory-tracking-in-jvm",target:"_blank",rel:"noopener noreferrer"}},[s._v("native-memory-tracking-in-jvm"),t("OutboundLink")],1)]),s._v(" "),t("li",[t("a",{attrs:{href:"https://docs.oracle.com/javase/8/docs/technotes/guides/vm/nmt-8.html",target:"_blank",rel:"noopener noreferrer"}},[s._v("Native Memory Tracking"),t("OutboundLink")],1)]),s._v(" "),t("li",[t("a",{attrs:{href:"https://docs.oracle.com/en/java/javase/18/troubleshoot/troubleshooting-memory-leaks.html#GUID-79F26B47-9240-4F32-A817-1DD77A361F31",target:"_blank",rel:"noopener noreferrer"}},[s._v("Diagnosing Native Memory Leaks"),t("OutboundLink")],1)])])])}),[],!1,null,null,null);a.default=n.exports}}]);