(window.webpackJsonp=window.webpackJsonp||[]).push([[240],{672:function(l,e,t){"use strict";t.r(e);var r=t(34),a=Object(r.a)({},(function(){var l=this,e=l.$createElement,t=l._self._c||e;return t("ContentSlotsDistributor",{attrs:{"slot-key":l.$parent.slotKey}},[t("h1",{attrs:{id:"epoll"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#epoll"}},[l._v("#")]),l._v(" EPoll")]),l._v(" "),t("h2",{attrs:{id:"epoll介绍"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#epoll介绍"}},[l._v("#")]),l._v(" EPoll介绍")]),l._v(" "),t("p",[l._v("EPoll是linux提供的网络事件通知框架。\n在网络交互中，代码关心的是，什么时候有数据可读（对方发送了请求或对方请求返回数据返回了），\n什么时候可以写数据，有哪些客户端建连。")]),l._v(" "),t("p",[l._v("每个连接在linux中通过fd(file descriptor)表示，我们需要监听各个fd的可读可写事件。\n在早期linux提供的是poll的机制，缺点是随着要监听的fd数量变多，poll的遍历开销越来越大。\nepoll是全新的扩展性更好的实现，不会因为fd增多而性能下降。")]),l._v(" "),t("p",[l._v("epoll API的核心概念是epoll实例。通过API epoll_create可以创建epoll实例，epoll实例表示一个内核数据结构，\n在用户态视角，可以把它想象成两个list的容器。")]),l._v(" "),t("ul",[t("li",[l._v("interest list : 包含的是对哪些fd(连接）的那些事件（可读、可写、可accept等）感兴趣")]),l._v(" "),t("li",[l._v("ready list: 哪些fd的IO事件准备好了。ready list是interest list的子集。ready list是内核根据IO活动变化动态维护的。")])]),l._v(" "),t("p",[l._v("应用层可以通过如下的系统调用来使用epoll")]),l._v(" "),t("ul",[t("li",[l._v("epoll_create : 创建一个新的epoll实例，返回指向这个实例的fd")]),l._v(" "),t("li",[l._v("epoll_ctl : 通过epoll_ctl能够添加、修改、删除感兴趣的fd事件")]),l._v(" "),t("li",[l._v("epoll_wait : 等待I/O事件，没有I/O事件时会阻塞调用线程，直到有I/O事件或超过传入的超时时间")])]),l._v(" "),t("p",[l._v("edge-triggered 和 level-triggered, 默认是level-triggered模式，edge-triggered模式下，如果出现可读事件，\nepoll_wait会返回，但是后面再收到的数据调用epoll_wait不能获取到可读事件，level-triggered模式没有这个问题。")]),l._v(" "),t("h3",{attrs:{id:"epoll参考文档"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#epoll参考文档"}},[l._v("#")]),l._v(" EPoll参考文档")]),l._v(" "),t("p",[t("a",{attrs:{href:"https://man7.org/linux/man-pages/man7/epoll.7.html",target:"_blank",rel:"noopener noreferrer"}},[l._v("linux man pages epoll"),t("OutboundLink")],1)]),l._v(" "),t("h2",{attrs:{id:"epollselectorimpl"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#epollselectorimpl"}},[l._v("#")]),l._v(" EPollSelectorImpl")])])}),[],!1,null,null,null);e.default=a.exports}}]);