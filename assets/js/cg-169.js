(window.webpackJsonp=window.webpackJsonp||[]).push([[169],{599:function(t,e,n){"use strict";n.r(e);var o=n(34),a=Object(o.a)({},(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[n("h1",{attrs:{id:"g1-humongous"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#g1-humongous"}},[t._v("#")]),t._v(" g1 humongous")]),t._v(" "),n("p",[t._v("humongous region是给对象大小超过RegionSize的一半的对象使用的。\n什么样的对象大小会这么大呢？\n对于普通的对象，大小包含object header(markword和metadata)，在64位开启指针压缩的情况下\n占用12byte，然后是对象字段空间，包含继承父类的字段和自身的字段，和字段类型和数量有关，正常情况下\n不会很多，最后会有一个8字节的对齐。\n所以普通对象的对象大小不可能超过RegionSize一半，因为Region最小是1MB，一半是512KB。\n能够容纳13万个字段，几乎不可能有定义了13万字段的类。")]),t._v(" "),n("p",[t._v("除了普通对象，还有数组对象。\n数组对象的大小和元素数量有关，比如一个byte数组长度是1万，则大小为12byte(对象头) + 4byte（对象长度）+1万*1byte=97kb。")]),t._v(" "),n("p",[t._v("那么数组在哪些场景下会使用呢？")]),t._v(" "),n("ul",[n("li",[t._v("字符串")]),t._v(" "),n("li",[t._v("ArrayList")]),t._v(" "),n("li",[t._v("ByteBuffer")]),t._v(" "),n("li",[t._v("其他")])]),t._v(" "),n("p",[t._v("当发现有非常多的Humongous Region导致GC频繁触发时，该如何定位到问题代码呢？")]),t._v(" "),n("ul",[n("li",[t._v("通过JFR，能够展示一段时间内allocation即内存申请的火焰图，并且能够看到哪些数组的allocation的大小最多，并且能够看到线程栈")]),t._v(" "),n("li",[t._v("heap dump，保留all对象。")])])])}),[],!1,null,null,null);e.default=a.exports}}]);