<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>garbage first collector | bytejava Java进阶手册</title>
    <meta name="generator" content="VuePress 1.9.7">
    <link rel="icon" href="/favicon.ico">
    <script charset="utf-8" async="async" src="/js/jquery.min.js"></script>
    <script charset="utf-8" async="async" src="/js/global.js"></script>
    <script charset="utf-8" async="async" src="/js/fingerprint2.min.js"></script>
    <script charset="utf-8" async="async" src="https://s9.cnzz.com/z_stat.php?id=12782949&amp;web_id=1272949"></script>
    <script>
              var _hmt = _hmt || [];
              (function() {
                var hm = document.createElement("script");
                hm.src = "https://hm.baidu.com/hm.js?fa0fbf0fef3bba94118b912a64766cee";
                var s = document.getElementsByTagName("script")[0];
                s.parentNode.insertBefore(hm, s);
              })();
            </script>
    <meta name="description" content="包含: Java 基础，高并发缓存，JVM，中间件，字节码编程...">
    <meta property="og:title" content="garbage first collector">
    <meta property="og:type" content="article">
    <meta property="og:url" content="/md/jvm/gc/g1/g1.html">
    <meta name="twitter:title" content="garbage first collector">
    <meta name="twitter:url" content="/md/jvm/gc/g1/g1.html">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="robots" content="all">
    <meta name="author" content="bytejava">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <meta name="keywords" content="bytejava 高级Java，Java设计模式, 字节码编程, 中间件, Spring, Java基础, 面经手册">
    <meta name="apple-mobile-web-app-capable" content="yes">
    
    <link rel="preload" href="/assets/css/0.styles.8fb5e8ac.css" as="style"><link rel="preload" href="/assets/css/styles.css?v=1729221831211" as="style"><link rel="preload" href="/assets/js/cg-styles.js?v=1729221831211" as="script"><link rel="preload" href="/assets/js/cg-app.js?v=1729221831211" as="script"><link rel="preload" href="/assets/js/cg-4.js?v=1729221831211" as="script"><link rel="preload" href="/assets/js/cg-3.js?v=1729221831211" as="script"><link rel="preload" href="/assets/js/cg-172.js?v=1729221831211" as="script">
    <link rel="stylesheet" href="/assets/css/0.styles.8fb5e8ac.css"><link rel="stylesheet" href="/assets/css/styles.css?v=1729221831211">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">bytejava Java进阶手册</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Java" class="dropdown-title"><span class="title">Java</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/md/java/basic/java线程池.html" class="nav-link">
  Java基础
</a></li><li class="dropdown-item"><!----> <a href="/md/java/compiler/javac.html" class="nav-link">
  Java编译器
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="JVM" class="dropdown-title"><span class="title">JVM</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/md/jvm/bytecode/class字节码文件格式.html" class="nav-link">
  字节码
</a></li><li class="dropdown-item"><!----> <a href="/md/jvm/jvm/javaagent.html" class="nav-link">
  jvm
</a></li><li class="dropdown-item"><!----> <a href="/md/jvm/jvmti/jvmti介绍和开发.html" class="nav-link">
  jvmti
</a></li><li class="dropdown-item"><!----> <a href="/md/jvm/gc/g1/g1-all-intro.html" class="nav-link">
  G1 GC
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="缓存" class="dropdown-title"><span class="title">缓存</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/md/cache/redis/redis.html" class="nav-link">
  零基础到高并发应用专家，深入理解redis
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Spring" class="dropdown-title"><span class="title">Spring</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/md/spring/springboot启动请求处理过程.html" class="nav-link">
  Spring实现
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Kafka" class="dropdown-title"><span class="title">Kafka</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/md/kafka/kafka.html" class="nav-link">
  kafka
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="MyBatis" class="dropdown-title"><span class="title">MyBatis</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/md/mybatis/mybatis-use-general.html" class="nav-link">
  MyBatis
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="业务开发" class="dropdown-title"><span class="title">业务开发</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/md/develop/" class="nav-link">
  业务开发
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="中间件" class="dropdown-title"><span class="title">中间件</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/md/distribute/raft.html" class="nav-link">
  raft
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="算法" class="dropdown-title"><span class="title">算法</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/md/algorithm/leetcode.html" class="nav-link">
  算法
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="软技能通用技能" class="dropdown-title"><span class="title">软技能通用技能</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/md/soft/晋升答辩.html" class="nav-link">
  晋升答辩
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="专栏" class="dropdown-title"><span class="title">专栏</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/md/column/column.html" class="nav-link">
  订阅我的专栏
</a></li></ul></div></div><div class="nav-item"><a href="https://github.com/liuzhengyang" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Java" class="dropdown-title"><span class="title">Java</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/md/java/basic/java线程池.html" class="nav-link">
  Java基础
</a></li><li class="dropdown-item"><!----> <a href="/md/java/compiler/javac.html" class="nav-link">
  Java编译器
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="JVM" class="dropdown-title"><span class="title">JVM</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/md/jvm/bytecode/class字节码文件格式.html" class="nav-link">
  字节码
</a></li><li class="dropdown-item"><!----> <a href="/md/jvm/jvm/javaagent.html" class="nav-link">
  jvm
</a></li><li class="dropdown-item"><!----> <a href="/md/jvm/jvmti/jvmti介绍和开发.html" class="nav-link">
  jvmti
</a></li><li class="dropdown-item"><!----> <a href="/md/jvm/gc/g1/g1-all-intro.html" class="nav-link">
  G1 GC
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="缓存" class="dropdown-title"><span class="title">缓存</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/md/cache/redis/redis.html" class="nav-link">
  零基础到高并发应用专家，深入理解redis
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Spring" class="dropdown-title"><span class="title">Spring</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/md/spring/springboot启动请求处理过程.html" class="nav-link">
  Spring实现
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Kafka" class="dropdown-title"><span class="title">Kafka</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/md/kafka/kafka.html" class="nav-link">
  kafka
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="MyBatis" class="dropdown-title"><span class="title">MyBatis</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/md/mybatis/mybatis-use-general.html" class="nav-link">
  MyBatis
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="业务开发" class="dropdown-title"><span class="title">业务开发</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/md/develop/" class="nav-link">
  业务开发
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="中间件" class="dropdown-title"><span class="title">中间件</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/md/distribute/raft.html" class="nav-link">
  raft
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="算法" class="dropdown-title"><span class="title">算法</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/md/algorithm/leetcode.html" class="nav-link">
  算法
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="软技能通用技能" class="dropdown-title"><span class="title">软技能通用技能</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/md/soft/晋升答辩.html" class="nav-link">
  晋升答辩
</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="专栏" class="dropdown-title"><span class="title">专栏</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/md/column/column.html" class="nav-link">
  订阅我的专栏
</a></li></ul></div></div><div class="nav-item"><a href="https://github.com/liuzhengyang" target="_blank" rel="noopener noreferrer" class="nav-link external">
  Github
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>G1 GC</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/md/jvm/gc/g1/g1-all-intro.html" class="sidebar-link">G1 GC核心原理介绍</a></li></ul></section></li></ul> </aside> <div><main class="withouttoc page"> <div class="theme-default-content content__default"><h1 id="garbage-first-collector"><a href="#garbage-first-collector" class="header-anchor">#</a> garbage first collector</h1> <p>GC: 自动内存管理，内存分配、回收。</p> <p>为什么需要G1 GC。</p> <p>之前的GC有，PS, CMS。</p> <p>停顿时间</p> <p>为什么内存越来越大？代码逻辑复杂（本地缓存等常驻对象）</p> <p>garbage first: 垃圾优先。</p> <h2 id="agenda"><a href="#agenda" class="header-anchor">#</a> agenda</h2> <h3 id="内存管理"><a href="#内存管理" class="header-anchor">#</a> 内存管理</h3> <p>分配、回收</p> <p>内存分布、内存区域:</p> <p>Heap, Metaspace, Thread, Direct Memory, GC, Code, 其他</p> <h3 id="g1核心概念"><a href="#g1核心概念" class="header-anchor">#</a> G1核心概念</h3> <h4 id="一些关键参数"><a href="#一些关键参数" class="header-anchor">#</a> 一些关键参数</h4> <h3 id="g1流程"><a href="#g1流程" class="header-anchor">#</a> G1流程</h3> <h4 id="young-only"><a href="#young-only" class="header-anchor">#</a> Young Only</h4> <h4 id="mixed-gc"><a href="#mixed-gc" class="header-anchor">#</a> Mixed GC</h4> <h4 id="concurrent-cycle"><a href="#concurrent-cycle" class="header-anchor">#</a> Concurrent Cycle</h4> <h4 id="full-gc"><a href="#full-gc" class="header-anchor">#</a> Full GC</h4> <h4 id="other"><a href="#other" class="header-anchor">#</a> Other</h4> <p>humongous object 哪些对象容易成为humongous， 数组</p> <p>发生时机: ExplicitGC</p> <p>Concurrent</p> <p>reference processing</p> <p>Direct Memory/DirectByteBuffer</p> <h2 id="关键词、术语解释"><a href="#关键词、术语解释" class="header-anchor">#</a> 关键词、术语解释</h2> <p>mutator: 指应用程序，mutator能够修改状态。
allocator: 内存分配器，负责维护可用内存、分配内存</p> <p>GCLocker
G1 Evacuation Pause
remember set sample</p> <ul><li>Region</li> <li>IHOP</li> <li>AdaptiveIHOP</li> <li>mixed gc</li> <li>collection set</li> <li>remember set</li> <li>card table, sparse, grain</li> <li>dirty card</li> <li>snapshot-at-the-beginning, satb</li> <li>write barrier</li> <li>refine</li> <li>evacuation failure</li> <li>humongous</li> <li>concurrent mark</li> <li>mark bitmap</li> <li>root scan</li> <li>clean up</li> <li>young region size policy</li> <li>mark stack</li> <li>refinement</li> <li>remembered set sampling task</li> <li>gclocker</li></ul> <h2 id="gc介绍和java-gc演进历史"><a href="#gc介绍和java-gc演进历史" class="header-anchor">#</a> GC介绍和Java GC演进历史</h2> <p>在编写Java代码时，程序员创建完对象后，不需要对对象内存进行释放，这极大
提升了开发效率。</p> <p>G1 GC的特点。</p> <h2 id="g1关键设计"><a href="#g1关键设计" class="header-anchor">#</a> G1关键设计</h2> <p>Garbage first含义为垃圾优先，即优先回收垃圾比较多的Region，使用更小的成本获得更大的收益。</p> <p>在G1之前，服务端大多使用CMS(Concurrent Marking Sweep)收集器，
CMS在回收年轻代时使用复制算法，在回收老年代时使用标记清除算法，标记清除过程中分为若干个STW（stop the world)和并发阶段。
标记清除的一个缺点是有内存碎片问题，内存碎片达到一定程度后，只能通过Full GC或通过压缩来解决，这两种操作的耗时都相对比较长。</p> <p>和CMS不同的是，G1将内存划分为N个大小相等的Region，每个Region是一块连续的内存块，N为接近2048的数字，且保证每个Region的内存大小为1MB, 2MB, 4MB, 8MB,
16MB, 32MB其中的一个。</p> <p>G1也采用了分代收集策略，逻辑上分为年轻代（包含Eden和Survivor）和老年代。</p> <p>不过分代只是逻辑上的，并不需要在Region内连续，并且每个region可能会随着gc变化而改变自己的类型。</p> <p>分配对象内存时，会在eden区域中分配（默认会通过TLAB）。</p> <p>如果对象大小比较大超过了Region大小的一半，则认为是巨型对象(humongous object)，巨型对象会单独占用若干个连续的Region，
巨型对象也属于老年代，这是因为巨型对象的对象移动成本比较高，gc时需要移动比较多的内存。</p> <p>G1的年轻代的大小上限，也是动态变化的（在G1NewSizePercent和G1MaxNewSizePercent之间），目的是能够动态调整控制暂停时间。</p> <p>G1的回收分为两种类型，一种是普通的young gc(也称为young only gc)只回收所有年轻代的region；另一种是mixed gc，除了回收所有年轻代的region，
还会同时回收一部分老年代的region。</p> <p>在Eden区用完时，G1会发起young gc，young gc时，g1会将Eden和Survivor的region中的对象进行扫描，找出存活对象，
通过复制算法复制到新的Survivor，如果对象的age达到晋升老年代的阈值，则会晋升到老年代，年龄阈值会动态进行计算。</p> <p>在young gc结束或humongous object对象分配时，G1会计算老年代的空间占总堆内存的比例，是否超过InitiatingHeapOccupancyPercent（默认45%，默认情况即开启G1UseAdaptiveIHOP时G1会动态调节InitiatingHeapOccupancyPercent）。
如果超过，G1会发起concurrent cycle即并发标记周期。</p> <p>concurrent cycle包含几个阶段，首先会通过一次YGC顺带进行初始标记来标记gc roots直接引用的对象。
Concurrent Scan Root Regions
Concurrent Mark, Concurrent Mark From Roots
Concurrent Preclean</p> <p>Remark</p> <p>Concurrent Mark Cleanup</p> <p>IHOP计算时机</p> <p>Full GC</p> <p>evacuation failure(to space exhausted)</p> <p>Humongous Allocation</p> <h2 id="g1重要参数配置"><a href="#g1重要参数配置" class="header-anchor">#</a> g1重要参数配置</h2> <ul><li>InitialRAMPercentage</li> <li>MaxRAMPercentage</li> <li>MaxGCPauseMillis</li> <li>G1NewSizePercent</li> <li>G1MaxNewSizePercent</li> <li>G1ReservePercent</li> <li>G1UseAdaptiveIHOP</li> <li>InitiatingHeapOccupancyPercent</li> <li>G1HeapRegionSize</li> <li>ParallelGCThreads</li> <li>ConcGCThreads</li> <li>G1ConcRefinementThreads</li> <li>G1HeapWastePercent</li> <li>G1MixedGCLiveThresholdPercent</li></ul> <h2 id="region"><a href="#region" class="header-anchor">#</a> region</h2> <p>在启动时，如果用户没有指定G1HeapRegionSize配置，g1会计算region大小，
region的大小只能是1MB, 2Mb, 4MB, 8MB, 16Mb, 32MB，</p> <p>计算逻辑如下，
首先读取jvm参数G1HeapRegionSize，如果等于0即没有配置，则会使用heap的最大大小（通过MaxHeapSize或MaxRAMPercentage等方式配置）除以target_number（2048)
计算region size，如果小于1MB，则使用1MB。</p> <p>在region size大于1MB的情况下（用户配置或计算出来的），则通过round_up_power_of_2得到大于等于resize的最小的2的次方值，比如计算得到region size
为3.1MB，则round_up_power_of_2得到4MB。</p> <p>clamp方法，再次限制下region size最大为32MB，最小为1MB</p> <div class="language-text line-numbers-mode"><pre class="language-text"><code>size_t region_size = G1HeapRegionSize;
// G1HeapRegionSize = 0 means decide ergonomically.
if (region_size == 0) {
region_size = MAX2(max_heap_size / HeapRegionBounds::target_number(),
                   HeapRegionBounds::min_size());
}

// Make sure region size is a power of 2. Rounding up since this
// is beneficial in most cases.
region_size = round_up_power_of_2(region_size);

// Now make sure that we don't go over or under our limits.
region_size = clamp(region_size, HeapRegionBounds::min_size(), HeapRegionBounds::max_size());
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><h2 id="region管理"><a href="#region管理" class="header-anchor">#</a> region管理</h2> <p>Region管理在G1HeapRegionTable中，是一个链表</p> <h2 id="gc-types"><a href="#gc-types" class="header-anchor">#</a> gc types</h2> <p>gc type
gc name</p> <h2 id="normal-gc过程"><a href="#normal-gc过程" class="header-anchor">#</a> Normal gc过程</h2> <h3 id="gc触发时机"><a href="#gc触发时机" class="header-anchor">#</a> gc触发时机</h3> <p>allocator负责为mutator分配内存。
在分配内存时，发现当前的region内存不足，需要申请使用新的region来分配内存时，会通过
G1Policy的should_allocate_mutator_region方法判断当前是young_list_length是否小于young_list_target_length，来决定是否还能申请新的region。</p> <div class="language-text line-numbers-mode"><pre class="language-text"><code>bool G1Policy::should_allocate_mutator_region() const {
  uint young_list_length = _g1h-&gt;young_regions_count();
  uint young_list_target_length = _young_list_target_length;
  return young_list_length &amp;lt; young_list_target_length;
}
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><p>每次gc结束时，g1都会通过gc耗时来调整young_list_target_length，以便让下次gc pause time能够尽量符合MaxGCPauseMillis。</p> <p>gc类型。</p> <ul><li>Normal</li> <li>Prepared Mixed</li></ul> <p>发起时机</p> <p>young only gc是指普通的</p> <h3 id="scan-evac-扫描过程和复制、清除过程"><a href="#scan-evac-扫描过程和复制、清除过程" class="header-anchor">#</a> scan&amp;evac 扫描过程和复制、清除过程</h3> <p>forward copy
ParScanState push on queue</p> <p>清除</p> <p>G1ScanEvacuatedObjClosure</p> <h2 id="safepoint"><a href="#safepoint" class="header-anchor">#</a> safepoint</h2> <h2 id="refine"><a href="#refine" class="header-anchor">#</a> refine</h2> <p>refine线程是什么，在做什么事情？</p> <h2 id="parallelgcthread"><a href="#parallelgcthread" class="header-anchor">#</a> ParallelGCThread</h2> <p>ParallelGCThread和ConcGCThread的区别：</p> <h2 id="concgcthread"><a href="#concgcthread" class="header-anchor">#</a> ConcGCThread</h2> <h2 id="remembered-set"><a href="#remembered-set" class="header-anchor">#</a> remembered set</h2> <p>每个region都有自己的一个remembered set，
remembered set中保存的是所有可能只想当前region中对象的对象的位置。为什么说是有可能有呢，
因为有可能赋值之后又删除了。</p> <p>比如从region A创建了一个到region B中的对象的引用关联，则
jvm会通过write buffer的方式，在将region B中的对象引用复制到region A中的对象时，
在region B的remembered set中加入region A的对象的信息。
记录的方式使用到了card table，heap中每512个byte的card对应card table中的一个byte的entry。</p> <p>每个线程都有自己关联的remembered set log, 是当前</p> <p>除此之外还有一个全局的filled RS buffer set集合。</p> <p>remembered set本身是一个set（通过hash table实现的，就像Java中的HashSet通过HashMap实现的一样）。</p> <p>remembered set的作用</p> <p>部分回收时，不用扫描全部heap；迁移对象位置时，只需要对remembered set中的对象进行指针修改。</p> <p>forwarder
marker
summarizer</p> <h2 id="normal-gc"><a href="#normal-gc" class="header-anchor">#</a> normal gc</h2> <p>什么时候进行 normal gc(young gc)</p> <p>G1 Evacuation Pause</p> <p>Parallel Copy</p> <p>g1 如何并行处理、如何划分任务的？</p> <h2 id="mixed-gc-2"><a href="#mixed-gc-2" class="header-anchor">#</a> mixed gc</h2> <p>prepared mixed: 在mixed gc前的最后一次 young only gc，目的是减少年轻代的大小，以便在mixed gc时，同时回收全部young + 部分old region
也能满足MaxGCPauseMillis的暂停要求。</p> <p>什么时候结束mixed gc (target count, waste percent)</p> <h3 id="concurrent-marking"><a href="#concurrent-marking" class="header-anchor">#</a> Concurrent Marking</h3> <p>什么时候开始marking</p> <p>Concurrent start</p> <p>当old gen的内存空间占总的堆内存空间的比例超过IHOP后，g1会发起concurrent marking，来
对准备mixed需要的信息。</p> <p>concurrent marking阶段完后后，g1会开启G1MixedGCCountTarget(默认8)次mixed gc，
每次mixed gc的开始时间同样是eden已满，每次mixed gc，g1会把young gen的全部region和若干个g1认为回收价值最大的old区的region
放到一起进行回收。</p> <h2 id="full-gc-2"><a href="#full-gc-2" class="header-anchor">#</a> Full GC</h2> <p>Full GC的暂停时间</p> <p>FullGC触发原因</p> <p>metaspace</p> <p>oom触发时机</p> <h2 id="gc-log配置、阅读"><a href="#gc-log配置、阅读" class="header-anchor">#</a> GC log配置、阅读</h2> <p>日志分析、阅读、调优</p> <p>snapshot-at-the-beginning concurrent marking</p> <p>TAMS</p> <h3 id="gc-log"><a href="#gc-log" class="header-anchor">#</a> gc log</h3> <p>通过增加<code>-Xlog:gc*=debug</code>可以查看详细的gc日志，默认会输出到标准输出。</p> <p>Normal G1 Evacuation Pause
GCLock Initiated GC</p> <p>Prepare Mixed</p> <div class="language-shell line-numbers-mode"><pre class="language-shell"><code><span class="token comment"># 在gc之前，打印heap的占用信息。包含total,young,survivor、metaspace的大小信息</span>
<span class="token punctuation">[</span><span class="token number">3</span>.525s<span class="token punctuation">]</span><span class="token punctuation">[</span>debug<span class="token punctuation">]</span><span class="token punctuation">[</span>gc,heap        <span class="token punctuation">]</span> GC<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> Heap before GC <span class="token assign-left variable">invocations</span><span class="token operator">=</span><span class="token number">2</span> <span class="token punctuation">(</span>full <span class="token number">0</span><span class="token punctuation">)</span>: garbage-first heap   total 524288K, used 55448K <span class="token punctuation">[</span>0x0000000600000000, 0x0000000800000000<span class="token punctuation">)</span>
<span class="token punctuation">[</span><span class="token number">3</span>.525s<span class="token punctuation">]</span><span class="token punctuation">[</span>debug<span class="token punctuation">]</span><span class="token punctuation">[</span>gc,heap        <span class="token punctuation">]</span> GC<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>   region size 2048K, <span class="token number">19</span> young <span class="token punctuation">(</span>38912K<span class="token punctuation">)</span>, <span class="token number">2</span> survivors <span class="token punctuation">(</span>4096K<span class="token punctuation">)</span>
<span class="token punctuation">[</span><span class="token number">3</span>.525s<span class="token punctuation">]</span><span class="token punctuation">[</span>debug<span class="token punctuation">]</span><span class="token punctuation">[</span>gc,heap        <span class="token punctuation">]</span> GC<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>  Metaspace       used 14741K, capacity 14989K, committed 15360K, reserved 1062912K
<span class="token punctuation">[</span><span class="token number">3</span>.525s<span class="token punctuation">]</span><span class="token punctuation">[</span>debug<span class="token punctuation">]</span><span class="token punctuation">[</span>gc,heap        <span class="token punctuation">]</span> GC<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>   class space    used 1356K, capacity 1442K, committed 1536K, reserved 1048576K

<span class="token comment"># Pause Young (Normal) 表示进行的是一个普通的年轻代的GC，除了Normal还有Prepare Mixed、Concurrent Start、Mixed、Full等</span>
<span class="token comment"># G1 Evacuation Pause表示gc cause，是因为g1要清理排空现在的young region（满了）进行gc</span>
<span class="token punctuation">[</span><span class="token number">3</span>.525s<span class="token punctuation">]</span><span class="token punctuation">[</span>info <span class="token punctuation">]</span><span class="token punctuation">[</span>gc,start       <span class="token punctuation">]</span> GC<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> Pause Young <span class="token punctuation">(</span>Normal<span class="token punctuation">)</span> <span class="token punctuation">(</span>G1 Evacuation Pause<span class="token punctuation">)</span>


<span class="token comment"># 使用了12个worker进行evacuation清理</span>
<span class="token punctuation">[</span><span class="token number">3</span>.525s<span class="token punctuation">]</span><span class="token punctuation">[</span>info <span class="token punctuation">]</span><span class="token punctuation">[</span>gc,task        <span class="token punctuation">]</span> GC<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> Using <span class="token number">12</span> workers of <span class="token number">13</span> <span class="token keyword">for</span> evacuation

<span class="token comment"># TLAB的统计，关于TLAB信息可以在TLAB的文章中查询</span>
<span class="token punctuation">[</span><span class="token number">3</span>.525s<span class="token punctuation">]</span><span class="token punctuation">[</span>debug<span class="token punctuation">]</span><span class="token punctuation">[</span>gc,tlab        <span class="token punctuation">]</span> GC<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> TLAB totals: thrds: <span class="token number">2</span>  refills: <span class="token number">63</span> max: <span class="token number">62</span> slow allocs: <span class="token number">7</span> max <span class="token number">7</span> waste:  <span class="token number">0.9</span>% gc: 229712B max: 229712B slow: 79184B max: 79184B fast: 0B max: 0B

// mutator指jvm中运行的应用程序待，allocation 统计，一共17个region，wasted size为0B。
<span class="token punctuation">[</span><span class="token number">3</span>.525s<span class="token punctuation">]</span><span class="token punctuation">[</span>debug<span class="token punctuation">]</span><span class="token punctuation">[</span>gc,alloc,region<span class="token punctuation">]</span> GC<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> Mutator Allocation stats, regions: <span class="token number">17</span>, wasted size: 0B <span class="token punctuation">(</span> <span class="token number">0.0</span>%<span class="token punctuation">)</span>

<span class="token comment"># g1计算survivor的大小为3145728 byte，计算出来对象的晋升到old的年龄阈值为15（threshold最大也是15)</span>
<span class="token punctuation">[</span><span class="token number">3</span>.525s<span class="token punctuation">]</span><span class="token punctuation">[</span>debug<span class="token punctuation">]</span><span class="token punctuation">[</span>gc,age         <span class="token punctuation">]</span> GC<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> Desired survivor size <span class="token number">3145728</span> bytes, new threshold <span class="token number">15</span> <span class="token punctuation">(</span>max threshold <span class="token number">15</span><span class="token punctuation">)</span>

<span class="token comment"># 选择CSet, CSet指Collection Set，也就是本次gc要回收哪些region。</span>
<span class="token punctuation">[</span><span class="token number">3</span>.525s<span class="token punctuation">]</span><span class="token punctuation">[</span>debug<span class="token punctuation">]</span><span class="token punctuation">[</span>gc,ergo,cset   <span class="token punctuation">]</span> GC<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> Finish choosing CSet. old: <span class="token number">0</span> regions, predicted old region time: <span class="token number">0</span>.00ms, <span class="token function">time</span> remaining: <span class="token number">6.56</span>

<span class="token comment"># refine线程，还没有启动worker</span>
<span class="token punctuation">[</span><span class="token number">3</span>.525s<span class="token punctuation">]</span><span class="token punctuation">[</span>debug<span class="token punctuation">]</span><span class="token punctuation">[</span>gc,refine      <span class="token punctuation">]</span> Activated worker <span class="token number">0</span>, on threshold: <span class="token number">17</span>, current: <span class="token number">17</span>

<span class="token comment"># termination统计</span>
<span class="token punctuation">[</span><span class="token number">3</span>.525s<span class="token punctuation">]</span><span class="token punctuation">[</span>debug<span class="token punctuation">]</span><span class="token punctuation">[</span>gc,task,stats  <span class="token punctuation">]</span> GC<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> GC Termination Stats
<span class="token punctuation">[</span><span class="token number">3</span>.525s<span class="token punctuation">]</span><span class="token punctuation">[</span>debug<span class="token punctuation">]</span><span class="token punctuation">[</span>gc,task,stats  <span class="token punctuation">]</span> GC<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>      elapsed  --strong roots-- -------termination------- ------waste <span class="token punctuation">(</span>KiB<span class="token punctuation">)</span>------
<span class="token punctuation">[</span><span class="token number">3</span>.525s<span class="token punctuation">]</span><span class="token punctuation">[</span>debug<span class="token punctuation">]</span><span class="token punctuation">[</span>gc,task,stats  <span class="token punctuation">]</span> GC<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> thr     ms        ms      %        ms      %    attempts  total   alloc    undo
<span class="token punctuation">[</span><span class="token number">3</span>.525s<span class="token punctuation">]</span><span class="token punctuation">[</span>debug<span class="token punctuation">]</span><span class="token punctuation">[</span>gc,task,stats  <span class="token punctuation">]</span> GC<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> --- --------- --------- ------ --------- ------ -------- ------- ------- -------
<span class="token punctuation">[</span><span class="token number">3</span>.531s<span class="token punctuation">]</span><span class="token punctuation">[</span>debug<span class="token punctuation">]</span><span class="token punctuation">[</span>gc,task,stats  <span class="token punctuation">]</span> GC<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>   <span class="token number">0</span>      <span class="token number">6.00</span>      <span class="token number">1.30</span>  <span class="token number">21.64</span>      <span class="token number">0.85</span>  <span class="token number">14.10</span>        <span class="token number">3</span>       <span class="token number">3</span>       <span class="token number">3</span>       <span class="token number">0</span>
<span class="token punctuation">[</span><span class="token number">3</span>.531s<span class="token punctuation">]</span><span class="token punctuation">[</span>debug<span class="token punctuation">]</span><span class="token punctuation">[</span>gc,task,stats  <span class="token punctuation">]</span> GC<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>   <span class="token number">6</span>      <span class="token number">5.60</span>      <span class="token number">1.66</span>  <span class="token number">29.58</span>      <span class="token number">0.29</span>   <span class="token number">5.25</span>        <span class="token number">4</span>       <span class="token number">0</span>       <span class="token number">0</span>       <span class="token number">0</span>
<span class="token punctuation">[</span><span class="token number">3</span>.531s<span class="token punctuation">]</span><span class="token punctuation">[</span>debug<span class="token punctuation">]</span><span class="token punctuation">[</span>gc,task,stats  <span class="token punctuation">]</span> GC<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>   <span class="token number">9</span>      <span class="token number">5.41</span>      <span class="token number">0.38</span>   <span class="token number">7.06</span>      <span class="token number">0.29</span>   <span class="token number">5.40</span>        <span class="token number">3</span>       <span class="token number">0</span>       <span class="token number">0</span>       <span class="token number">0</span>
<span class="token punctuation">[</span><span class="token number">3</span>.531s<span class="token punctuation">]</span><span class="token punctuation">[</span>debug<span class="token punctuation">]</span><span class="token punctuation">[</span>gc,task,stats  <span class="token punctuation">]</span> GC<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>  <span class="token number">10</span>      <span class="token number">5.44</span>      <span class="token number">0.87</span>  <span class="token number">16.02</span>      <span class="token number">0.29</span>   <span class="token number">5.40</span>        <span class="token number">3</span>       <span class="token number">0</span>       <span class="token number">0</span>       <span class="token number">0</span>
<span class="token punctuation">[</span><span class="token number">3</span>.531s<span class="token punctuation">]</span><span class="token punctuation">[</span>debug<span class="token punctuation">]</span><span class="token punctuation">[</span>gc,task,stats  <span class="token punctuation">]</span> GC<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>   <span class="token number">4</span>      <span class="token number">6.15</span>      <span class="token number">5.94</span>  <span class="token number">96.61</span>      <span class="token number">0.00</span>   <span class="token number">0.07</span>        <span class="token number">1</span>       <span class="token number">1</span>       <span class="token number">1</span>       <span class="token number">0</span>
<span class="token punctuation">[</span><span class="token number">3</span>.532s<span class="token punctuation">]</span><span class="token punctuation">[</span>debug<span class="token punctuation">]</span><span class="token punctuation">[</span>gc,task,stats  <span class="token punctuation">]</span> GC<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>   <span class="token number">5</span>      <span class="token number">6.44</span>      <span class="token number">0.76</span>  <span class="token number">11.82</span>      <span class="token number">3.13</span>  <span class="token number">48.57</span>        <span class="token number">1</span>       <span class="token number">0</span>       <span class="token number">0</span>       <span class="token number">0</span>
<span class="token punctuation">[</span><span class="token number">3</span>.532s<span class="token punctuation">]</span><span class="token punctuation">[</span>debug<span class="token punctuation">]</span><span class="token punctuation">[</span>gc,task,stats  <span class="token punctuation">]</span> GC<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>   <span class="token number">1</span>      <span class="token number">6.50</span>      <span class="token number">2.10</span>  <span class="token number">32.36</span>      <span class="token number">3.16</span>  <span class="token number">48.65</span>        <span class="token number">1</span>       <span class="token number">1</span>       <span class="token number">1</span>       <span class="token number">0</span>
<span class="token punctuation">[</span><span class="token number">3</span>.532s<span class="token punctuation">]</span><span class="token punctuation">[</span>debug<span class="token punctuation">]</span><span class="token punctuation">[</span>gc,task,stats  <span class="token punctuation">]</span> GC<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>   <span class="token number">7</span>      <span class="token number">5.93</span>      <span class="token number">0.13</span>   <span class="token number">2.16</span>      <span class="token number">3.23</span>  <span class="token number">54.42</span>        <span class="token number">1</span>       <span class="token number">0</span>       <span class="token number">0</span>       <span class="token number">0</span>
<span class="token punctuation">[</span><span class="token number">3</span>.532s<span class="token punctuation">]</span><span class="token punctuation">[</span>debug<span class="token punctuation">]</span><span class="token punctuation">[</span>gc,task,stats  <span class="token punctuation">]</span> GC<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>   <span class="token number">3</span>      <span class="token number">6.67</span>      <span class="token number">3.05</span>  <span class="token number">45.69</span>      <span class="token number">3.34</span>  <span class="token number">50.01</span>        <span class="token number">1</span>       <span class="token number">1</span>       <span class="token number">1</span>       <span class="token number">0</span>
<span class="token punctuation">[</span><span class="token number">3</span>.532s<span class="token punctuation">]</span><span class="token punctuation">[</span>debug<span class="token punctuation">]</span><span class="token punctuation">[</span>gc,task,stats  <span class="token punctuation">]</span> GC<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>   <span class="token number">8</span>      <span class="token number">6.03</span>      <span class="token number">0.42</span>   <span class="token number">6.89</span>      <span class="token number">2.30</span>  <span class="token number">38.14</span>        <span class="token number">5</span>       <span class="token number">0</span>       <span class="token number">0</span>       <span class="token number">0</span>
<span class="token punctuation">[</span><span class="token number">3</span>.532s<span class="token punctuation">]</span><span class="token punctuation">[</span>debug<span class="token punctuation">]</span><span class="token punctuation">[</span>gc,task,stats  <span class="token punctuation">]</span> GC<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>  <span class="token number">11</span>      <span class="token number">6.08</span>      <span class="token number">0.38</span>   <span class="token number">6.30</span>      <span class="token number">2.21</span>  <span class="token number">36.38</span>        <span class="token number">3</span>       <span class="token number">0</span>       <span class="token number">0</span>       <span class="token number">0</span>
<span class="token punctuation">[</span><span class="token number">3</span>.532s<span class="token punctuation">]</span><span class="token punctuation">[</span>debug<span class="token punctuation">]</span><span class="token punctuation">[</span>gc,task,stats  <span class="token punctuation">]</span> GC<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>   <span class="token number">2</span>      <span class="token number">6.81</span>      <span class="token number">4.35</span>  <span class="token number">63.90</span>      <span class="token number">2.35</span>  <span class="token number">34.51</span>        <span class="token number">1</span>       <span class="token number">0</span>       <span class="token number">0</span>       <span class="token number">0</span>

<span class="token comment">#  </span>
<span class="token punctuation">[</span><span class="token number">3</span>.532s<span class="token punctuation">]</span><span class="token punctuation">[</span>debug<span class="token punctuation">]</span><span class="token punctuation">[</span>gc,ergo        <span class="token punctuation">]</span> GC<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> Running G1 Clear Card Table Task using <span class="token number">1</span> workers <span class="token keyword">for</span> <span class="token number">1</span> <span class="token function">units</span> of work <span class="token keyword">for</span> <span class="token number">27</span> regions.

<span class="token comment">#</span>
<span class="token punctuation">[</span><span class="token number">3</span>.532s<span class="token punctuation">]</span><span class="token punctuation">[</span>debug<span class="token punctuation">]</span><span class="token punctuation">[</span>gc,ref         <span class="token punctuation">]</span> GC<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> Skipped phase1 of Reference Processing due to unavailable references

<span class="token comment">#</span>
<span class="token punctuation">[</span><span class="token number">3</span>.534s<span class="token punctuation">]</span><span class="token punctuation">[</span>debug<span class="token punctuation">]</span><span class="token punctuation">[</span>gc,ergo        <span class="token punctuation">]</span> GC<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> Running G1 Free Collection Set using <span class="token number">1</span> workers <span class="token keyword">for</span> collection <span class="token builtin class-name">set</span> length <span class="token number">19</span>

<span class="token comment"># 打印humongous region信息</span>
<span class="token punctuation">[</span><span class="token number">3</span>.534s<span class="token punctuation">]</span><span class="token punctuation">[</span>debug<span class="token punctuation">]</span><span class="token punctuation">[</span>gc,humongous   <span class="token punctuation">]</span> GC<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> Live humongous region <span class="token number">0</span> object size <span class="token number">1197440</span> start 0x0000000600000000  with remset <span class="token number">1</span> code roots <span class="token number">0</span> is marked <span class="token number">0</span> reclaim candidate <span class="token number">0</span> <span class="token builtin class-name">type</span> array <span class="token number">1</span>
<span class="token punctuation">[</span><span class="token number">3</span>.534s<span class="token punctuation">]</span><span class="token punctuation">[</span>debug<span class="token punctuation">]</span><span class="token punctuation">[</span>gc,humongous   <span class="token punctuation">]</span> GC<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> Live humongous region <span class="token number">1</span> object size <span class="token number">1660744</span> start 0x0000000600200000  with remset <span class="token number">1</span> code roots <span class="token number">0</span> is marked <span class="token number">0</span> reclaim candidate <span class="token number">0</span> <span class="token builtin class-name">type</span> array <span class="token number">1</span>


<span class="token comment"># PLAB的统计信息</span>
<span class="token punctuation">[</span><span class="token number">3</span>.534s<span class="token punctuation">]</span><span class="token punctuation">[</span>debug<span class="token punctuation">]</span><span class="token punctuation">[</span>gc,plab        <span class="token punctuation">]</span> GC<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> Young PLAB allocation: allocated: 2176416B, wasted: 10112B, unused: 132568B, used: 2033736B, undo waste: 0B, 
<span class="token punctuation">[</span><span class="token number">3</span>.534s<span class="token punctuation">]</span><span class="token punctuation">[</span>debug<span class="token punctuation">]</span><span class="token punctuation">[</span>gc,plab        <span class="token punctuation">]</span> GC<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> Young other allocation: region end waste: 289064B, regions filled: <span class="token number">2</span>, direct allocated: 1346512B, failure used: 0B, failure wasted: 0B
<span class="token punctuation">[</span><span class="token number">3</span>.534s<span class="token punctuation">]</span><span class="token punctuation">[</span>debug<span class="token punctuation">]</span><span class="token punctuation">[</span>gc,plab        <span class="token punctuation">]</span> GC<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> Young sizing: calculated: 348928B, actual: 322152B
<span class="token punctuation">[</span><span class="token number">3</span>.534s<span class="token punctuation">]</span><span class="token punctuation">[</span>debug<span class="token punctuation">]</span><span class="token punctuation">[</span>gc,plab        <span class="token punctuation">]</span> GC<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> Old PLAB allocation: allocated: 0B, wasted: 0B, unused: 0B, used: 0B, undo waste: 0B, 
<span class="token punctuation">[</span><span class="token number">3</span>.534s<span class="token punctuation">]</span><span class="token punctuation">[</span>debug<span class="token punctuation">]</span><span class="token punctuation">[</span>gc,plab        <span class="token punctuation">]</span> GC<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> Old other allocation: region end waste: 0B, regions filled: <span class="token number">1</span>, direct allocated: 0B, failure used: 0B, failure wasted: 0B
<span class="token punctuation">[</span><span class="token number">3</span>.534s<span class="token punctuation">]</span><span class="token punctuation">[</span>debug<span class="token punctuation">]</span><span class="token punctuation">[</span>gc,plab        <span class="token punctuation">]</span> GC<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> Old sizing: calculated: 0B, actual: 63416B


<span class="token comment"># 打印IHOP的信息，包含threshold（发起concurrent marking阶段的阈值)</span>
<span class="token punctuation">[</span><span class="token number">3</span>.534s<span class="token punctuation">]</span><span class="token punctuation">[</span>debug<span class="token punctuation">]</span><span class="token punctuation">[</span>gc,ihop        <span class="token punctuation">]</span> GC<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> Basic information <span class="token punctuation">(</span>value update<span class="token punctuation">)</span>, threshold: 241591910B <span class="token punctuation">(</span><span class="token number">45.00</span><span class="token punctuation">)</span>, target occupancy: 536870912B, current occupancy: 24162968B, recent allocation size: 0B, recent allocation duration: <span class="token number">789</span>.54ms, recent old gen allocation rate: <span class="token number">0</span>.00B/s, recent marking phase length: <span class="token number">0</span>.00ms
<span class="token comment"># 开启自适应调整IHOP后，会自动计算下一次的IHOP</span>
<span class="token punctuation">[</span><span class="token number">3</span>.534s<span class="token punctuation">]</span><span class="token punctuation">[</span>debug<span class="token punctuation">]</span><span class="token punctuation">[</span>gc,ihop        <span class="token punctuation">]</span> GC<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> Adaptive IHOP information <span class="token punctuation">(</span>value update<span class="token punctuation">)</span>, threshold: 241591910B <span class="token punctuation">(</span><span class="token number">47.37</span><span class="token punctuation">)</span>, internal target occupancy: 510027366B, occupancy: 24162968B, additional buffer size: 69206016B, predicted old gen allocation rate: <span class="token number">3712301</span>.35B/s, predicted marking phase length: <span class="token number">0</span>.00ms, prediction active: <span class="token boolean">false</span>

<span class="token comment"># Refinement Zones</span>
<span class="token punctuation">[</span><span class="token number">3</span>.534s<span class="token punctuation">]</span><span class="token punctuation">[</span>debug<span class="token punctuation">]</span><span class="token punctuation">[</span>gc,ergo,refine <span class="token punctuation">]</span> GC<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> Updated Refinement Zones: green: <span class="token number">15</span>, yellow: <span class="token number">45</span>, red: <span class="token number">75</span>
<span class="token punctuation">[</span><span class="token number">3</span>.534s<span class="token punctuation">]</span><span class="token punctuation">[</span>info <span class="token punctuation">]</span><span class="token punctuation">[</span>gc,phases      <span class="token punctuation">]</span> GC<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>   Pre Evacuate Collection Set: <span class="token number">0</span>.0ms
<span class="token punctuation">[</span><span class="token number">3</span>.534s<span class="token punctuation">]</span><span class="token punctuation">[</span>debug<span class="token punctuation">]</span><span class="token punctuation">[</span>gc,phases      <span class="token punctuation">]</span> GC<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>     Prepare TLABs: <span class="token number">0</span>.0ms
<span class="token punctuation">[</span><span class="token number">3</span>.534s<span class="token punctuation">]</span><span class="token punctuation">[</span>debug<span class="token punctuation">]</span><span class="token punctuation">[</span>gc,phases      <span class="token punctuation">]</span> GC<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>     Choose Collection Set: <span class="token number">0</span>.0ms
<span class="token punctuation">[</span><span class="token number">3</span>.534s<span class="token punctuation">]</span><span class="token punctuation">[</span>debug<span class="token punctuation">]</span><span class="token punctuation">[</span>gc,phases      <span class="token punctuation">]</span> GC<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>     Humongous Register: <span class="token number">0</span>.0ms

<span class="token comment"># 排空collection set</span>
<span class="token punctuation">[</span><span class="token number">3</span>.534s<span class="token punctuation">]</span><span class="token punctuation">[</span>info <span class="token punctuation">]</span><span class="token punctuation">[</span>gc,phases      <span class="token punctuation">]</span> GC<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>   Evacuate Collection Set: <span class="token number">6</span>.9ms
<span class="token comment"># 扫描ext root</span>
<span class="token punctuation">[</span><span class="token number">3</span>.534s<span class="token punctuation">]</span><span class="token punctuation">[</span>debug<span class="token punctuation">]</span><span class="token punctuation">[</span>gc,phases      <span class="token punctuation">]</span> GC<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>     Ext Root Scanning <span class="token punctuation">(</span>ms<span class="token punctuation">)</span>:   Min:  <span class="token number">0.0</span>, Avg:  <span class="token number">0.2</span>, Max:  <span class="token number">1.4</span>, Diff:  <span class="token number">1.4</span>, Sum:  <span class="token number">2.9</span>, Workers: <span class="token number">12</span>
<span class="token comment"># 更新remembered set</span>
<span class="token punctuation">[</span><span class="token number">3</span>.534s<span class="token punctuation">]</span><span class="token punctuation">[</span>debug<span class="token punctuation">]</span><span class="token punctuation">[</span>gc,phases      <span class="token punctuation">]</span> GC<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>     Update RS <span class="token punctuation">(</span>ms<span class="token punctuation">)</span>:           Min:  <span class="token number">0.0</span>, Avg:  <span class="token number">0.1</span>, Max:  <span class="token number">0.3</span>, Diff:  <span class="token number">0.3</span>, Sum:  <span class="token number">1.0</span>, Workers: <span class="token number">12</span>
<span class="token punctuation">[</span><span class="token number">3</span>.534s<span class="token punctuation">]</span><span class="token punctuation">[</span>debug<span class="token punctuation">]</span><span class="token punctuation">[</span>gc,phases      <span class="token punctuation">]</span> GC<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>       Processed Buffers:        Min: <span class="token number">0</span>, Avg:  <span class="token number">1.4</span>, Max: <span class="token number">3</span>, Diff: <span class="token number">3</span>, Sum: <span class="token number">17</span>, Workers: <span class="token number">12</span>
<span class="token punctuation">[</span><span class="token number">3</span>.534s<span class="token punctuation">]</span><span class="token punctuation">[</span>debug<span class="token punctuation">]</span><span class="token punctuation">[</span>gc,phases      <span class="token punctuation">]</span> GC<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>       Scanned Cards:            Min: <span class="token number">0</span>, Avg: <span class="token number">29.5</span>, Max: <span class="token number">111</span>, Diff: <span class="token number">111</span>, Sum: <span class="token number">354</span>, Workers: <span class="token number">12</span>
<span class="token punctuation">[</span><span class="token number">3</span>.534s<span class="token punctuation">]</span><span class="token punctuation">[</span>debug<span class="token punctuation">]</span><span class="token punctuation">[</span>gc,phases      <span class="token punctuation">]</span> GC<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>       Skipped Cards:            Min: <span class="token number">0</span>, Avg:  <span class="token number">0.1</span>, Max: <span class="token number">1</span>, Diff: <span class="token number">1</span>, Sum: <span class="token number">1</span>, Workers: <span class="token number">12</span>
<span class="token comment"># 扫描remembered set</span>
<span class="token punctuation">[</span><span class="token number">3</span>.534s<span class="token punctuation">]</span><span class="token punctuation">[</span>debug<span class="token punctuation">]</span><span class="token punctuation">[</span>gc,phases      <span class="token punctuation">]</span> GC<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>     Scan RS <span class="token punctuation">(</span>ms<span class="token punctuation">)</span>:             Min:  <span class="token number">0.0</span>, Avg:  <span class="token number">0.0</span>, Max:  <span class="token number">0.4</span>, Diff:  <span class="token number">0.4</span>, Sum:  <span class="token number">0.4</span>, Workers: <span class="token number">12</span>
<span class="token punctuation">[</span><span class="token number">3</span>.534s<span class="token punctuation">]</span><span class="token punctuation">[</span>debug<span class="token punctuation">]</span><span class="token punctuation">[</span>gc,phases      <span class="token punctuation">]</span> GC<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>       Scanned Cards:            Min: <span class="token number">0</span>, Avg:  <span class="token number">0.1</span>, Max: <span class="token number">1</span>, Diff: <span class="token number">1</span>, Sum: <span class="token number">1</span>, Workers: <span class="token number">12</span>
<span class="token punctuation">[</span><span class="token number">3</span>.535s<span class="token punctuation">]</span><span class="token punctuation">[</span>debug<span class="token punctuation">]</span><span class="token punctuation">[</span>gc,phases      <span class="token punctuation">]</span> GC<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>       Claimed Cards:            Min: <span class="token number">0</span>, Avg:  <span class="token number">0.1</span>, Max: <span class="token number">1</span>, Diff: <span class="token number">1</span>, Sum: <span class="token number">1</span>, Workers: <span class="token number">12</span>
<span class="token punctuation">[</span><span class="token number">3</span>.535s<span class="token punctuation">]</span><span class="token punctuation">[</span>debug<span class="token punctuation">]</span><span class="token punctuation">[</span>gc,phases      <span class="token punctuation">]</span> GC<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>       Skipped Cards:            Min: <span class="token number">0</span>, Avg:  <span class="token number">0.0</span>, Max: <span class="token number">0</span>, Diff: <span class="token number">0</span>, Sum: <span class="token number">0</span>, Workers: <span class="token number">12</span>
<span class="token comment"># 扫描code root</span>
<span class="token punctuation">[</span><span class="token number">3</span>.535s<span class="token punctuation">]</span><span class="token punctuation">[</span>debug<span class="token punctuation">]</span><span class="token punctuation">[</span>gc,phases      <span class="token punctuation">]</span> GC<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>     Code Root Scanning <span class="token punctuation">(</span>ms<span class="token punctuation">)</span>:  Min:  <span class="token number">0.0</span>, Avg:  <span class="token number">0.1</span>, Max:  <span class="token number">0.9</span>, Diff:  <span class="token number">0.9</span>, Sum:  <span class="token number">1.2</span>, Workers: <span class="token number">12</span>
<span class="token punctuation">[</span><span class="token number">3</span>.535s<span class="token punctuation">]</span><span class="token punctuation">[</span>debug<span class="token punctuation">]</span><span class="token punctuation">[</span>gc,phases      <span class="token punctuation">]</span> GC<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>     AOT Root Scanning <span class="token punctuation">(</span>ms<span class="token punctuation">)</span>:   skipped
<span class="token comment"># 复制对象</span>
<span class="token punctuation">[</span><span class="token number">3</span>.535s<span class="token punctuation">]</span><span class="token punctuation">[</span>debug<span class="token punctuation">]</span><span class="token punctuation">[</span>gc,phases      <span class="token punctuation">]</span> GC<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>     Object Copy <span class="token punctuation">(</span>ms<span class="token punctuation">)</span>:         Min:  <span class="token number">2.6</span>, Avg:  <span class="token number">3.8</span>, Max:  <span class="token number">5.1</span>, Diff:  <span class="token number">2.6</span>, Sum: <span class="token number">45.3</span>, Workers: <span class="token number">12</span>
<span class="token comment"># 结束</span>
<span class="token punctuation">[</span><span class="token number">3</span>.535s<span class="token punctuation">]</span><span class="token punctuation">[</span>debug<span class="token punctuation">]</span><span class="token punctuation">[</span>gc,phases      <span class="token punctuation">]</span> GC<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>     Termination <span class="token punctuation">(</span>ms<span class="token punctuation">)</span>:         Min:  <span class="token number">0.0</span>, Avg:  <span class="token number">1.8</span>, Max:  <span class="token number">3.3</span>, Diff:  <span class="token number">3.3</span>, Sum: <span class="token number">21.4</span>, Workers: <span class="token number">12</span>
<span class="token punctuation">[</span><span class="token number">3</span>.535s<span class="token punctuation">]</span><span class="token punctuation">[</span>debug<span class="token punctuation">]</span><span class="token punctuation">[</span>gc,phases      <span class="token punctuation">]</span> GC<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>       Termination Attempts:     Min: <span class="token number">1</span>, Avg:  <span class="token number">2.2</span>, Max: <span class="token number">5</span>, Diff: <span class="token number">4</span>, Sum: <span class="token number">27</span>, Workers: <span class="token number">12</span>
<span class="token comment"># gc worker 其他工作</span>
<span class="token punctuation">[</span><span class="token number">3</span>.535s<span class="token punctuation">]</span><span class="token punctuation">[</span>debug<span class="token punctuation">]</span><span class="token punctuation">[</span>gc,phases      <span class="token punctuation">]</span> GC<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>     GC Worker Other <span class="token punctuation">(</span>ms<span class="token punctuation">)</span>:     Min:  <span class="token number">0.0</span>, Avg:  <span class="token number">0.1</span>, Max:  <span class="token number">0.2</span>, Diff:  <span class="token number">0.2</span>, Sum:  <span class="token number">1.1</span>, Workers: <span class="token number">12</span>
<span class="token comment"># gc worker的总时间</span>
<span class="token punctuation">[</span><span class="token number">3</span>.535s<span class="token punctuation">]</span><span class="token punctuation">[</span>debug<span class="token punctuation">]</span><span class="token punctuation">[</span>gc,phases      <span class="token punctuation">]</span> GC<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>     GC Worker Total <span class="token punctuation">(</span>ms<span class="token punctuation">)</span>:     Min:  <span class="token number">5.4</span>, Avg:  <span class="token number">6.1</span>, Max:  <span class="token number">6.8</span>, Diff:  <span class="token number">1.4</span>, Sum: <span class="token number">73.4</span>, Workers: <span class="token number">12</span>
<span class="token comment"># evacuate collection set之后的工作</span>
<span class="token punctuation">[</span><span class="token number">3</span>.535s<span class="token punctuation">]</span><span class="token punctuation">[</span>info <span class="token punctuation">]</span><span class="token punctuation">[</span>gc,phases      <span class="token punctuation">]</span> GC<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>   Post Evacuate Collection Set: <span class="token number">2</span>.2ms
<span class="token punctuation">[</span><span class="token number">3</span>.535s<span class="token punctuation">]</span><span class="token punctuation">[</span>debug<span class="token punctuation">]</span><span class="token punctuation">[</span>gc,phases      <span class="token punctuation">]</span> GC<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>     Code Roots Fixup: <span class="token number">0</span>.0ms
<span class="token comment"># 清理card table</span>
<span class="token punctuation">[</span><span class="token number">3</span>.535s<span class="token punctuation">]</span><span class="token punctuation">[</span>debug<span class="token punctuation">]</span><span class="token punctuation">[</span>gc,phases      <span class="token punctuation">]</span> GC<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>     Clear Card Table: <span class="token number">0</span>.1ms
<span class="token comment"># 处理reference, WeakReference, SoftReference, PahntomReferences等</span>
<span class="token punctuation">[</span><span class="token number">3</span>.535s<span class="token punctuation">]</span><span class="token punctuation">[</span>debug<span class="token punctuation">]</span><span class="token punctuation">[</span>gc,phases      <span class="token punctuation">]</span> GC<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>     Reference Processing: <span class="token number">1</span>.3ms
<span class="token punctuation">[</span><span class="token number">3</span>.535s<span class="token punctuation">]</span><span class="token punctuation">[</span>debug<span class="token punctuation">]</span><span class="token punctuation">[</span>gc,phases,ref  <span class="token punctuation">]</span> GC<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>       Reconsider SoftReferences: <span class="token number">0</span>.0ms
<span class="token punctuation">[</span><span class="token number">3</span>.535s<span class="token punctuation">]</span><span class="token punctuation">[</span>debug<span class="token punctuation">]</span><span class="token punctuation">[</span>gc,phases,ref  <span class="token punctuation">]</span> GC<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>         SoftRef <span class="token punctuation">(</span>ms<span class="token punctuation">)</span>:             skipped
<span class="token punctuation">[</span><span class="token number">3</span>.535s<span class="token punctuation">]</span><span class="token punctuation">[</span>debug<span class="token punctuation">]</span><span class="token punctuation">[</span>gc,phases,ref  <span class="token punctuation">]</span> GC<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>       Notify Soft/WeakReferences: <span class="token number">0</span>.0ms
<span class="token punctuation">[</span><span class="token number">3</span>.535s<span class="token punctuation">]</span><span class="token punctuation">[</span>debug<span class="token punctuation">]</span><span class="token punctuation">[</span>gc,phases,ref  <span class="token punctuation">]</span> GC<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>         SoftRef <span class="token punctuation">(</span>ms<span class="token punctuation">)</span>:             Min:  <span class="token number">0.0</span>, Avg:  <span class="token number">0.0</span>, Max:  <span class="token number">0.0</span>, Diff:  <span class="token number">0.0</span>, Sum:  <span class="token number">0.0</span>, Workers: <span class="token number">1</span>
<span class="token punctuation">[</span><span class="token number">3</span>.535s<span class="token punctuation">]</span><span class="token punctuation">[</span>debug<span class="token punctuation">]</span><span class="token punctuation">[</span>gc,phases,ref  <span class="token punctuation">]</span> GC<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>         WeakRef <span class="token punctuation">(</span>ms<span class="token punctuation">)</span>:             Min:  <span class="token number">0.0</span>, Avg:  <span class="token number">0.0</span>, Max:  <span class="token number">0.0</span>, Diff:  <span class="token number">0.0</span>, Sum:  <span class="token number">0.0</span>, Workers: <span class="token number">1</span>
<span class="token punctuation">[</span><span class="token number">3</span>.535s<span class="token punctuation">]</span><span class="token punctuation">[</span>debug<span class="token punctuation">]</span><span class="token punctuation">[</span>gc,phases,ref  <span class="token punctuation">]</span> GC<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>         FinalRef <span class="token punctuation">(</span>ms<span class="token punctuation">)</span>:            Min:  <span class="token number">0.0</span>, Avg:  <span class="token number">0.0</span>, Max:  <span class="token number">0.0</span>, Diff:  <span class="token number">0.0</span>, Sum:  <span class="token number">0.0</span>, Workers: <span class="token number">1</span>
<span class="token punctuation">[</span><span class="token number">3</span>.535s<span class="token punctuation">]</span><span class="token punctuation">[</span>debug<span class="token punctuation">]</span><span class="token punctuation">[</span>gc,phases,ref  <span class="token punctuation">]</span> GC<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>         Total <span class="token punctuation">(</span>ms<span class="token punctuation">)</span>:               Min:  <span class="token number">0.0</span>, Avg:  <span class="token number">0.0</span>, Max:  <span class="token number">0.0</span>, Diff:  <span class="token number">0.0</span>, Sum:  <span class="token number">0.0</span>, Workers: <span class="token number">1</span>
<span class="token punctuation">[</span><span class="token number">3</span>.535s<span class="token punctuation">]</span><span class="token punctuation">[</span>debug<span class="token punctuation">]</span><span class="token punctuation">[</span>gc,phases,ref  <span class="token punctuation">]</span> GC<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>       Notify and keep alive finalizable: <span class="token number">1</span>.2ms
<span class="token punctuation">[</span><span class="token number">3</span>.535s<span class="token punctuation">]</span><span class="token punctuation">[</span>debug<span class="token punctuation">]</span><span class="token punctuation">[</span>gc,phases,ref  <span class="token punctuation">]</span> GC<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>         Balance queues: <span class="token number">0</span>.0ms
<span class="token punctuation">[</span><span class="token number">3</span>.535s<span class="token punctuation">]</span><span class="token punctuation">[</span>debug<span class="token punctuation">]</span><span class="token punctuation">[</span>gc,phases,ref  <span class="token punctuation">]</span> GC<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>         FinalRef <span class="token punctuation">(</span>ms<span class="token punctuation">)</span>:            Min:  <span class="token number">0.0</span>, Avg:  <span class="token number">0.6</span>, Max:  <span class="token number">1.2</span>, Diff:  <span class="token number">1.2</span>, Sum:  <span class="token number">7.5</span>, Workers: <span class="token number">12</span>
<span class="token punctuation">[</span><span class="token number">3</span>.535s<span class="token punctuation">]</span><span class="token punctuation">[</span>debug<span class="token punctuation">]</span><span class="token punctuation">[</span>gc,phases,ref  <span class="token punctuation">]</span> GC<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>       Notify PhantomReferences: <span class="token number">0</span>.0ms
<span class="token punctuation">[</span><span class="token number">3</span>.535s<span class="token punctuation">]</span><span class="token punctuation">[</span>debug<span class="token punctuation">]</span><span class="token punctuation">[</span>gc,phases,ref  <span class="token punctuation">]</span> GC<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>         PhantomRef <span class="token punctuation">(</span>ms<span class="token punctuation">)</span>:          Min:  <span class="token number">0.0</span>, Avg:  <span class="token number">0.0</span>, Max:  <span class="token number">0.0</span>, Diff:  <span class="token number">0.0</span>, Sum:  <span class="token number">0.0</span>, Workers: <span class="token number">1</span>
<span class="token punctuation">[</span><span class="token number">3</span>.535s<span class="token punctuation">]</span><span class="token punctuation">[</span>debug<span class="token punctuation">]</span><span class="token punctuation">[</span>gc,phases,ref  <span class="token punctuation">]</span> GC<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>       SoftReference:
<span class="token punctuation">[</span><span class="token number">3</span>.535s<span class="token punctuation">]</span><span class="token punctuation">[</span>debug<span class="token punctuation">]</span><span class="token punctuation">[</span>gc,phases,ref  <span class="token punctuation">]</span> GC<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>         Discovered: <span class="token number">0</span>
<span class="token punctuation">[</span><span class="token number">3</span>.535s<span class="token punctuation">]</span><span class="token punctuation">[</span>debug<span class="token punctuation">]</span><span class="token punctuation">[</span>gc,phases,ref  <span class="token punctuation">]</span> GC<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>         Cleared: <span class="token number">0</span>
<span class="token punctuation">[</span><span class="token number">3</span>.535s<span class="token punctuation">]</span><span class="token punctuation">[</span>debug<span class="token punctuation">]</span><span class="token punctuation">[</span>gc,phases,ref  <span class="token punctuation">]</span> GC<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>       WeakReference:
<span class="token punctuation">[</span><span class="token number">3</span>.535s<span class="token punctuation">]</span><span class="token punctuation">[</span>debug<span class="token punctuation">]</span><span class="token punctuation">[</span>gc,phases,ref  <span class="token punctuation">]</span> GC<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>         Discovered: <span class="token number">151</span>
<span class="token punctuation">[</span><span class="token number">3</span>.535s<span class="token punctuation">]</span><span class="token punctuation">[</span>debug<span class="token punctuation">]</span><span class="token punctuation">[</span>gc,phases,ref  <span class="token punctuation">]</span> GC<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>         Cleared: <span class="token number">88</span>
<span class="token punctuation">[</span><span class="token number">3</span>.535s<span class="token punctuation">]</span><span class="token punctuation">[</span>debug<span class="token punctuation">]</span><span class="token punctuation">[</span>gc,phases,ref  <span class="token punctuation">]</span> GC<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>       FinalReference:
<span class="token punctuation">[</span><span class="token number">3</span>.535s<span class="token punctuation">]</span><span class="token punctuation">[</span>debug<span class="token punctuation">]</span><span class="token punctuation">[</span>gc,phases,ref  <span class="token punctuation">]</span> GC<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>         Discovered: <span class="token number">15</span>
<span class="token punctuation">[</span><span class="token number">3</span>.535s<span class="token punctuation">]</span><span class="token punctuation">[</span>debug<span class="token punctuation">]</span><span class="token punctuation">[</span>gc,phases,ref  <span class="token punctuation">]</span> GC<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>         Cleared: <span class="token number">1</span>
<span class="token punctuation">[</span><span class="token number">3</span>.535s<span class="token punctuation">]</span><span class="token punctuation">[</span>debug<span class="token punctuation">]</span><span class="token punctuation">[</span>gc,phases,ref  <span class="token punctuation">]</span> GC<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>       PhantomReference:
<span class="token punctuation">[</span><span class="token number">3</span>.535s<span class="token punctuation">]</span><span class="token punctuation">[</span>debug<span class="token punctuation">]</span><span class="token punctuation">[</span>gc,phases,ref  <span class="token punctuation">]</span> GC<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>         Discovered: <span class="token number">231</span>
<span class="token punctuation">[</span><span class="token number">3</span>.535s<span class="token punctuation">]</span><span class="token punctuation">[</span>debug<span class="token punctuation">]</span><span class="token punctuation">[</span>gc,phases,ref  <span class="token punctuation">]</span> GC<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>         Cleared: <span class="token number">197</span>
<span class="token punctuation">[</span><span class="token number">3</span>.535s<span class="token punctuation">]</span><span class="token punctuation">[</span>debug<span class="token punctuation">]</span><span class="token punctuation">[</span>gc,phases      <span class="token punctuation">]</span> GC<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>     Weak Processing: <span class="token number">0</span>.4ms
<span class="token punctuation">[</span><span class="token number">3</span>.535s<span class="token punctuation">]</span><span class="token punctuation">[</span>debug<span class="token punctuation">]</span><span class="token punctuation">[</span>gc,phases      <span class="token punctuation">]</span> GC<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>     Merge Per-Thread State: <span class="token number">0</span>.0ms
<span class="token punctuation">[</span><span class="token number">3</span>.535s<span class="token punctuation">]</span><span class="token punctuation">[</span>debug<span class="token punctuation">]</span><span class="token punctuation">[</span>gc,phases      <span class="token punctuation">]</span> GC<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>     Code Roots Purge: <span class="token number">0</span>.0ms
<span class="token comment"># redirty card</span>
<span class="token punctuation">[</span><span class="token number">3</span>.535s<span class="token punctuation">]</span><span class="token punctuation">[</span>debug<span class="token punctuation">]</span><span class="token punctuation">[</span>gc,phases      <span class="token punctuation">]</span> GC<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>     Redirty Cards: <span class="token number">0</span>.1ms
<span class="token punctuation">[</span><span class="token number">3</span>.535s<span class="token punctuation">]</span><span class="token punctuation">[</span>debug<span class="token punctuation">]</span><span class="token punctuation">[</span>gc,phases      <span class="token punctuation">]</span> GC<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>     DerivedPointerTable Update: <span class="token number">0</span>.0ms
<span class="token comment"># 清理collection set</span>
<span class="token punctuation">[</span><span class="token number">3</span>.535s<span class="token punctuation">]</span><span class="token punctuation">[</span>debug<span class="token punctuation">]</span><span class="token punctuation">[</span>gc,phases      <span class="token punctuation">]</span> GC<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>     Free Collection Set: <span class="token number">0</span>.1ms
<span class="token comment"># reclaim humongous</span>
<span class="token punctuation">[</span><span class="token number">3</span>.535s<span class="token punctuation">]</span><span class="token punctuation">[</span>debug<span class="token punctuation">]</span><span class="token punctuation">[</span>gc,phases      <span class="token punctuation">]</span> GC<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>     Humongous Reclaim: <span class="token number">0</span>.1ms
<span class="token comment"># 创建新的collection set</span>
<span class="token punctuation">[</span><span class="token number">3</span>.535s<span class="token punctuation">]</span><span class="token punctuation">[</span>debug<span class="token punctuation">]</span><span class="token punctuation">[</span>gc,phases      <span class="token punctuation">]</span> GC<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>     Start New Collection Set: <span class="token number">0</span>.0ms
<span class="token comment"># 调整TLAB大小</span>
<span class="token punctuation">[</span><span class="token number">3</span>.535s<span class="token punctuation">]</span><span class="token punctuation">[</span>debug<span class="token punctuation">]</span><span class="token punctuation">[</span>gc,phases      <span class="token punctuation">]</span> GC<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>     Resize TLABs: <span class="token number">0</span>.0ms
<span class="token comment"># gc之后调整heap大小</span>
<span class="token punctuation">[</span><span class="token number">3</span>.535s<span class="token punctuation">]</span><span class="token punctuation">[</span>debug<span class="token punctuation">]</span><span class="token punctuation">[</span>gc,phases      <span class="token punctuation">]</span> GC<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>     Expand Heap After Collection: <span class="token number">0</span>.0ms
<span class="token comment"># 其他</span>
<span class="token punctuation">[</span><span class="token number">3</span>.535s<span class="token punctuation">]</span><span class="token punctuation">[</span>info <span class="token punctuation">]</span><span class="token punctuation">[</span>gc,phases      <span class="token punctuation">]</span> GC<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>   Other: <span class="token number">0</span>.3ms


<span class="token comment"># gc之后 eden, survivor, old, humongous, metaspace的大小变化</span>
<span class="token punctuation">[</span><span class="token number">3</span>.535s<span class="token punctuation">]</span><span class="token punctuation">[</span>info <span class="token punctuation">]</span><span class="token punctuation">[</span>gc,heap        <span class="token punctuation">]</span> GC<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> Eden regions: <span class="token number">17</span>-<span class="token operator">&gt;</span><span class="token number">0</span><span class="token punctuation">(</span><span class="token number">31</span><span class="token punctuation">)</span>
<span class="token punctuation">[</span><span class="token number">3</span>.535s<span class="token punctuation">]</span><span class="token punctuation">[</span>info <span class="token punctuation">]</span><span class="token punctuation">[</span>gc,heap        <span class="token punctuation">]</span> GC<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> Survivor regions: <span class="token number">2</span>-<span class="token operator">&gt;</span><span class="token number">2</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>
<span class="token punctuation">[</span><span class="token number">3</span>.535s<span class="token punctuation">]</span><span class="token punctuation">[</span>info <span class="token punctuation">]</span><span class="token punctuation">[</span>gc,heap        <span class="token punctuation">]</span> GC<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> Old regions: <span class="token number">8</span>-<span class="token operator">&gt;</span><span class="token number">8</span>
<span class="token punctuation">[</span><span class="token number">3</span>.535s<span class="token punctuation">]</span><span class="token punctuation">[</span>info <span class="token punctuation">]</span><span class="token punctuation">[</span>gc,heap        <span class="token punctuation">]</span> GC<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> Humongous regions: <span class="token number">2</span>-<span class="token operator">&gt;</span><span class="token number">2</span>
<span class="token punctuation">[</span><span class="token number">3</span>.535s<span class="token punctuation">]</span><span class="token punctuation">[</span>info <span class="token punctuation">]</span><span class="token punctuation">[</span>gc,metaspace   <span class="token punctuation">]</span> GC<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> Metaspace: 14741K-<span class="token operator">&gt;</span>14741K<span class="token punctuation">(</span>1062912K<span class="token punctuation">)</span>

<span class="token comment"># gc结束之后，打印heap各区域的信息</span>
<span class="token punctuation">[</span><span class="token number">3</span>.535s<span class="token punctuation">]</span><span class="token punctuation">[</span>debug<span class="token punctuation">]</span><span class="token punctuation">[</span>gc,heap        <span class="token punctuation">]</span> GC<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> Heap after GC <span class="token assign-left variable">invocations</span><span class="token operator">=</span><span class="token number">3</span> <span class="token punctuation">(</span>full <span class="token number">0</span><span class="token punctuation">)</span>: garbage-first heap   total 524288K, used 23596K <span class="token punctuation">[</span>0x0000000600000000, 0x0000000800000000<span class="token punctuation">)</span>
<span class="token punctuation">[</span><span class="token number">3</span>.535s<span class="token punctuation">]</span><span class="token punctuation">[</span>debug<span class="token punctuation">]</span><span class="token punctuation">[</span>gc,heap        <span class="token punctuation">]</span> GC<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>   region size 2048K, <span class="token number">2</span> young <span class="token punctuation">(</span>4096K<span class="token punctuation">)</span>, <span class="token number">2</span> survivors <span class="token punctuation">(</span>4096K<span class="token punctuation">)</span>
<span class="token punctuation">[</span><span class="token number">3</span>.535s<span class="token punctuation">]</span><span class="token punctuation">[</span>debug<span class="token punctuation">]</span><span class="token punctuation">[</span>gc,heap        <span class="token punctuation">]</span> GC<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>  Metaspace       used 14741K, capacity 14989K, committed 15360K, reserved 1062912K
<span class="token punctuation">[</span><span class="token number">3</span>.535s<span class="token punctuation">]</span><span class="token punctuation">[</span>debug<span class="token punctuation">]</span><span class="token punctuation">[</span>gc,heap        <span class="token punctuation">]</span> GC<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>   class space    used 1356K, capacity 1442K, committed 1536K, reserved 1048576K
<span class="token punctuation">[</span><span class="token number">3</span>.535s<span class="token punctuation">]</span><span class="token punctuation">[</span>info <span class="token punctuation">]</span><span class="token punctuation">[</span>gc             <span class="token punctuation">]</span> GC<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> Pause Young <span class="token punctuation">(</span>Normal<span class="token punctuation">)</span> <span class="token punctuation">(</span>G1 Evacuation Pause<span class="token punctuation">)</span> 56M-<span class="token operator">&gt;</span>23M<span class="token punctuation">(</span>512M<span class="token punctuation">)</span> <span class="token number">10</span>.241ms
<span class="token punctuation">[</span><span class="token number">3</span>.535s<span class="token punctuation">]</span><span class="token punctuation">[</span>info <span class="token punctuation">]</span><span class="token punctuation">[</span>gc,cpu         <span class="token punctuation">]</span> GC<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token assign-left variable">User</span><span class="token operator">=</span><span class="token number">0</span>.03s <span class="token assign-left variable">Sys</span><span class="token operator">=</span><span class="token number">0</span>.01s <span class="token assign-left variable">Real</span><span class="token operator">=</span><span class="token number">0</span>.01s
<span class="token punctuation">[</span><span class="token number">3</span>.535s<span class="token punctuation">]</span><span class="token punctuation">[</span>debug<span class="token punctuation">]</span><span class="token punctuation">[</span>gc,refine      <span class="token punctuation">]</span> Deactivated worker <span class="token number">0</span>, off threshold: <span class="token number">15</span>, current: <span class="token number">11</span>, processed: <span class="token number">0</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br><span class="line-number">132</span><br><span class="line-number">133</span><br><span class="line-number">134</span><br><span class="line-number">135</span><br><span class="line-number">136</span><br><span class="line-number">137</span><br><span class="line-number">138</span><br><span class="line-number">139</span><br><span class="line-number">140</span><br><span class="line-number">141</span><br><span class="line-number">142</span><br><span class="line-number">143</span><br><span class="line-number">144</span><br><span class="line-number">145</span><br><span class="line-number">146</span><br><span class="line-number">147</span><br><span class="line-number">148</span><br><span class="line-number">149</span><br><span class="line-number">150</span><br><span class="line-number">151</span><br><span class="line-number">152</span><br><span class="line-number">153</span><br><span class="line-number">154</span><br><span class="line-number">155</span><br><span class="line-number">156</span><br><span class="line-number">157</span><br><span class="line-number">158</span><br><span class="line-number">159</span><br><span class="line-number">160</span><br><span class="line-number">161</span><br><span class="line-number">162</span><br><span class="line-number">163</span><br><span class="line-number">164</span><br><span class="line-number">165</span><br><span class="line-number">166</span><br><span class="line-number">167</span><br><span class="line-number">168</span><br><span class="line-number">169</span><br><span class="line-number">170</span><br><span class="line-number">171</span><br><span class="line-number">172</span><br><span class="line-number">173</span><br><span class="line-number">174</span><br></div></div><h2 id="gc-log文件配置"><a href="#gc-log文件配置" class="header-anchor">#</a> gc log文件配置</h2> <h2 id="关于commit-reserved等概念"><a href="#关于commit-reserved等概念" class="header-anchor">#</a> 关于commit reserved等概念</h2> <h2 id="思考"><a href="#思考" class="header-anchor">#</a> 思考</h2> <h3 id="为什么region大小需要保证是2的n次方-为什么最大是32mb、最小是1mb"><a href="#为什么region大小需要保证是2的n次方-为什么最大是32mb、最小是1mb" class="header-anchor">#</a> 为什么Region大小需要保证是2的n次方？为什么最大是32MB、最小是1MB？</h3> <p>如果是2的n次方，比如是2的10次方（也就是1MB）则计算一个对象所在的region只需要用对象地址向右移10位，就得到了所在Region的内存起始位置（再左移10位）。
判断两个对象是否是同一个region，也只需要比较对象地址2进制表示的前若干位。在remembered set维护中，需要对不同region间的对象的引用更新remembered set。</p> <h3 id="为什么需要top-at-mark-start-是每个region都有自己的tams吗-包括年轻代"><a href="#为什么需要top-at-mark-start-是每个region都有自己的tams吗-包括年轻代" class="header-anchor">#</a> 为什么需要top at mark start? 是每个region都有自己的TAMS吗（包括年轻代？）</h3> <h3 id="concurrent-marking-会标记年轻代对象吗"><a href="#concurrent-marking-会标记年轻代对象吗" class="header-anchor">#</a> Concurrent Marking 会标记年轻代对象吗？</h3> <h3 id="为什么需要prev和next"><a href="#为什么需要prev和next" class="header-anchor">#</a> 为什么需要prev和next？</h3> <h3 id="concurrent-marking-会对tams之上的对象的字段遍历处理吗-为什么"><a href="#concurrent-marking-会对tams之上的对象的字段遍历处理吗-为什么" class="header-anchor">#</a> Concurrent Marking 会对TAMS之上的对象的字段遍历处理吗？为什么？</h3> <h3 id="concurrent-marking过程中-eden用完了-会发生什么-full-gc-or-concurrent-marking-中断重新开始"><a href="#concurrent-marking过程中-eden用完了-会发生什么-full-gc-or-concurrent-marking-中断重新开始" class="header-anchor">#</a> Concurrent Marking过程中，eden用完了，会发生什么? Full GC? or Concurrent Marking 中断重新开始？</h3> <h3 id="young-gc-如果出现promotion-failure-会出现什么情况"><a href="#young-gc-如果出现promotion-failure-会出现什么情况" class="header-anchor">#</a> young gc，如果出现promotion failure，会出现什么情况？</h3> <p>G1ReservePercent</p> <h2 id="参考"><a href="#参考" class="header-anchor">#</a> 参考</h2> <ul><li><a href="https://www.redhat.com/en/blog/part-1-introduction-g1-garbage-collector" target="_blank" rel="noopener noreferrer">Part 1: Introduction to the G1 Garbage Collector<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li> <li><a href="https://www.redhat.com/en/blog/collecting-and-reading-g1-garbage-collector-logs-part-2" target="_blank" rel="noopener noreferrer">collecting-and-reading-g1-garbage-collector-logs-part-2<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></li></ul></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/liuzhengyang/liuzhengyang.github.io/edit/master/docs/md/jvm/gc/g1/g1.md" target="_blank" rel="noopener noreferrer">Edit this page</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <!----></footer> <!----> </main></div> <aside class="page-sidebar"> <div class="page-side-toolbar"><!----> <div class="option-box-toc-over"><img src="/images/system/toc.png" class="nozoom"> <span class="show-txt">目录</span> <div class="toc-container"><div class="pos-box"><div class="icon-arrow"></div> <div class="scroll-box" style="max-height:550px"><div style="font-weight:bold;text-align:center;">garbage first collector</div> <hr> <div class="toc-box"><ul class="toc-sidebar-links"><li><a href="/md/jvm/gc/g1/g1.html#agenda" class="toc-sidebar-link">agenda</a><ul class="toc-sidebar-sub-headers"><li class="toc-sidebar-sub-header"><a href="/md/jvm/gc/g1/g1.html#内存管理" class="toc-sidebar-link">内存管理</a></li><li class="toc-sidebar-sub-header"><a href="/md/jvm/gc/g1/g1.html#g1核心概念" class="toc-sidebar-link">G1核心概念</a></li><li class="toc-sidebar-sub-header"><a href="/md/jvm/gc/g1/g1.html#g1流程" class="toc-sidebar-link">G1流程</a></li></ul></li><li><a href="/md/jvm/gc/g1/g1.html#关键词、术语解释" class="toc-sidebar-link">关键词、术语解释</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/md/jvm/gc/g1/g1.html#gc介绍和java-gc演进历史" class="toc-sidebar-link">GC介绍和Java GC演进历史</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/md/jvm/gc/g1/g1.html#g1关键设计" class="toc-sidebar-link">G1关键设计</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/md/jvm/gc/g1/g1.html#g1重要参数配置" class="toc-sidebar-link">g1重要参数配置</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/md/jvm/gc/g1/g1.html#region" class="toc-sidebar-link">region</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/md/jvm/gc/g1/g1.html#region管理" class="toc-sidebar-link">region管理</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/md/jvm/gc/g1/g1.html#gc-types" class="toc-sidebar-link">gc types</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/md/jvm/gc/g1/g1.html#normal-gc过程" class="toc-sidebar-link">Normal gc过程</a><ul class="toc-sidebar-sub-headers"><li class="toc-sidebar-sub-header"><a href="/md/jvm/gc/g1/g1.html#gc触发时机" class="toc-sidebar-link">gc触发时机</a></li><li class="toc-sidebar-sub-header"><a href="/md/jvm/gc/g1/g1.html#scan-evac-扫描过程和复制、清除过程" class="toc-sidebar-link">scan&amp;evac 扫描过程和复制、清除过程</a></li></ul></li><li><a href="/md/jvm/gc/g1/g1.html#safepoint" class="toc-sidebar-link">safepoint</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/md/jvm/gc/g1/g1.html#refine" class="toc-sidebar-link">refine</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/md/jvm/gc/g1/g1.html#parallelgcthread" class="toc-sidebar-link">ParallelGCThread</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/md/jvm/gc/g1/g1.html#concgcthread" class="toc-sidebar-link">ConcGCThread</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/md/jvm/gc/g1/g1.html#remembered-set" class="toc-sidebar-link">remembered set</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/md/jvm/gc/g1/g1.html#normal-gc" class="toc-sidebar-link">normal gc</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/md/jvm/gc/g1/g1.html#mixed-gc-2" class="toc-sidebar-link">mixed gc</a><ul class="toc-sidebar-sub-headers"><li class="toc-sidebar-sub-header"><a href="/md/jvm/gc/g1/g1.html#concurrent-marking" class="toc-sidebar-link">Concurrent Marking</a></li></ul></li><li><a href="/md/jvm/gc/g1/g1.html#full-gc-2" class="toc-sidebar-link">Full GC</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/md/jvm/gc/g1/g1.html#gc-log配置、阅读" class="toc-sidebar-link">GC log配置、阅读</a><ul class="toc-sidebar-sub-headers"><li class="toc-sidebar-sub-header"><a href="/md/jvm/gc/g1/g1.html#gc-log" class="toc-sidebar-link">gc log</a></li></ul></li><li><a href="/md/jvm/gc/g1/g1.html#gc-log文件配置" class="toc-sidebar-link">gc log文件配置</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/md/jvm/gc/g1/g1.html#关于commit-reserved等概念" class="toc-sidebar-link">关于commit reserved等概念</a><ul class="toc-sidebar-sub-headers"></ul></li><li><a href="/md/jvm/gc/g1/g1.html#思考" class="toc-sidebar-link">思考</a><ul class="toc-sidebar-sub-headers"><li class="toc-sidebar-sub-header"><a href="/md/jvm/gc/g1/g1.html#为什么region大小需要保证是2的n次方-为什么最大是32mb、最小是1mb" class="toc-sidebar-link">为什么Region大小需要保证是2的n次方？为什么最大是32MB、最小是1MB？</a></li><li class="toc-sidebar-sub-header"><a href="/md/jvm/gc/g1/g1.html#为什么需要top-at-mark-start-是每个region都有自己的tams吗-包括年轻代" class="toc-sidebar-link">为什么需要top at mark start? 是每个region都有自己的TAMS吗（包括年轻代？）</a></li><li class="toc-sidebar-sub-header"><a href="/md/jvm/gc/g1/g1.html#concurrent-marking-会标记年轻代对象吗" class="toc-sidebar-link">Concurrent Marking 会标记年轻代对象吗？</a></li><li class="toc-sidebar-sub-header"><a href="/md/jvm/gc/g1/g1.html#为什么需要prev和next" class="toc-sidebar-link">为什么需要prev和next？</a></li><li class="toc-sidebar-sub-header"><a href="/md/jvm/gc/g1/g1.html#concurrent-marking-会对tams之上的对象的字段遍历处理吗-为什么" class="toc-sidebar-link">Concurrent Marking 会对TAMS之上的对象的字段遍历处理吗？为什么？</a></li><li class="toc-sidebar-sub-header"><a href="/md/jvm/gc/g1/g1.html#concurrent-marking过程中-eden用完了-会发生什么-full-gc-or-concurrent-marking-中断重新开始" class="toc-sidebar-link">Concurrent Marking过程中，eden用完了，会发生什么? Full GC? or Concurrent Marking 中断重新开始？</a></li><li class="toc-sidebar-sub-header"><a href="/md/jvm/gc/g1/g1.html#young-gc-如果出现promotion-failure-会出现什么情况" class="toc-sidebar-link">young gc，如果出现promotion failure，会出现什么情况？</a></li></ul></li><li><a href="/md/jvm/gc/g1/g1.html#参考" class="toc-sidebar-link">参考</a><ul class="toc-sidebar-sub-headers"></ul></li></ul></div></div></div></div></div> <div class="option-box"><img src="/images/system/wechat.png" class="nozoom"> <span class="show-txt">手机看</span> <div class="toc-container"><div class="pos-box"><div class="icon-arrow"></div> <div class="scroll-box" style="text-align:center"><span style="font-size:0.9rem">微信扫一扫</span> <img height="180px" src="https://api.qrserver.com/v1/create-qr-code/?data=https://bytejava.cn/md/jvm/gc/g1/g1.html" style="margin:10px;">
                可以<b>手机看</b>或分享至<b>朋友圈</b></div></div></div></div> <div class="option-box"><img src="/images/personal/wechat-mp-logo.jpg" height="20" class="nozoom"> <span class="show-txt">公众号</span> <div class="toc-container"><div class="pos-box"><div class="icon-arrow"></div> <div class="scroll-box" style="text-align:center"><span style="font-size:0.9rem">关注公众号bytejava</span> <img src="/images/personal/wechat-mp.png" height="180" width></div></div></div></div> <div class="option-box"><img src="/images/system/toggle.png" width="30px" class="nozoom"> <span class="show-txt">左栏</span></div> <div class="option-box"><img src="/images/system/heart-1.png" width="25px" class="nozoom"> <span class="show-txt">赞赏我</span> <div class="toc-container"><div class="pos-box"><div class="icon-arrow"></div> <div class="scroll-box" style="text-align:center"><span style="font-size:0.8rem;font-weight:bold;">鼓励/支持/赞赏我</span> <img height="180px" src="/images/personal/encourage-head.jpg" style="margin:5px;"> <br>1. 不靠它生存但仍希望得到你的鼓励；
                <br>2. 时刻警醒自己保持技术人的初心，沉淀，分享，成长；
              </div></div></div></div> <!----> <!----></div>  <!----> </aside></div><div class="global-ui"></div></div>
    <script src="/assets/js/cg-styles.js?v=1729221831211" defer></script><script src="/assets/js/cg-4.js?v=1729221831211" defer></script><script src="/assets/js/cg-3.js?v=1729221831211" defer></script><script src="/assets/js/cg-172.js?v=1729221831211" defer></script><script src="/assets/js/cg-app.js?v=1729221831211" defer></script>
  </body>
</html>
